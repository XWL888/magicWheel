webpackJsonp([1],{"1KYS":function(t,e){},"36zy":function(t,e){},"4Ej+":function(t,e){},"7Q5p":function(t,e){t.exports={title:"魔法轮",version:"1.0.1",id:"cjsn27u650000rr687is144nj",stages:[]}},"8lK+":function(t,e){},A7jK:function(t,e){},B2fp:function(t,e){},CZzb:function(t,e){},"E/U7":function(t,e){t.exports={port:8080}},G137:function(t,e){},IcnI:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("xd7I"),s=a("2bvH"),n=a("004W");a.n(n);i.default.use(s.a);const l={clearLoadData({state:t}){t.loadData.pageNum=null,t.loadData.restTime=null},upDateInfo({state:t},{answerInfo:e,nextStudentNum:a}){store.dispatch("upDateLoadInfo",{answerInfo:e}),store.dispatch("upDateAnswerStatus"),store.dispatch("upDateCurrentStudent",{nextStudentNum:a})},upDateCurrentStudent({state:t},{nextStudentNum:e}){t.currentStudent=e},upDateLoadInfo({state:t},{answerInfo:e}){Array.isArray(e)?t.loadInfo=e:"boolean"==typeof e?t.loadInfo.push(e):t.loadInfo=[]},upDateAnswerStatus({state:t}){t.answerStatus=[];for(let e=0;e<t.testNum;e++){let a;a=!0===t.loadInfo[e]?2:!1===t.loadInfo[e]?3:1,t.answerStatus[e]=a}},postAnswer({state:t}){console.log(t.postArr,"整体答题数据"),Object(n.postAnswer)(t.postArr,t.testNum)},defaultPushToPostArr({state:t},e){t.postArr.push(e)},increment({state:t}){t.pageNumber++,console.log(t)},decrement({state:t}){t.pageNumber--},setPageNumber({state:t},e){t.pageNumber=e},pushToPostArr({state:t},e){console.log(e,"第"+e.id+"道题答题数据"),t.postArr.splice(e.id,1,e)}},o={setIsPost(t,e){t.isShow=e},setpIsPost(t,e){t.pisShow=e}};window.store=new s.a.Store({state:{postArr:[],resultArr:[],pisShow:!1,pShow:!1,goldnum:0,testNum:1,result:[],isShow:!1,pageNumber:0,question:null,answerStatus:[],sources:[],loadInfo:[],currentStudent:1},actions:l,mutations:o})},JKkS:function(t,e){},MClN:function(t,e){},MzDr:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("xd7I"),s=a("ghBa"),n=a("TRsl"),l=a("QBX4");a("IcnI");var o={name:"App",data:()=>({}),components:{End:n.a,Pend:l.a},computed:{isShow:(t,e)=>store.state.isShow,pisShow:(t,e)=>store.state.pisShow},mounted(){console.log("APP组件加载完成")}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("router-view"),t._v(" "),t.isShow?a("End"):t._e(),t._v(" "),t.pisShow?a("Pend"):t._e(),t._v(" "),t.$store.state.isShow?a("div",{staticClass:"text"}):t._e()],1)},staticRenderFns:[]};var m=a("C7Lr")(o,r,!1,function(t){a("A7jK")},null,null).exports,d=a("3XdE"),g=a("zwgh"),c=(a("X86l"),a("r14f")),u=a.n(c),h=a("xtmC"),p=a.n(h),v=a("UH4H");let w={default:{jewelKey:"image_jewelDefault"},currentDefault:{jewelKey:"image_jewelCurrent",border:"image_jewelCurrentBg"},currentRight:{jewelKey:"image_jewelCurrentRight",border:"image_jewelRightBg"},currentWrong:{jewelKey:"image_jewelCurrentWrong",border:"image_jewelCurrentBg"},rightEd:{jewelKey:"image_jewelRightEd",border:"image_jewelRightBg"},wrongEd:{jewelKey:"image_jewelWrongEd",border:"image_jewelCurrentBg"}};const f=781.5,b=529.5;let y="image_jewelBg";class x{constructor(t){this.self=t,this.game=t.game,this.jewel={},this.jewelCon=new PIXI.Container,this.rotation=2*Math.PI/store.state.testNum}init(){let t=store.state.pageNumber;store.state.answerStatus.forEach((e,a)=>{let i=1===e?"default":2===e?"rightEd":"wrongEd";a===t&&(i="currentDefault");let s=this.add(i);s.rotation=-1*a*this.rotation,this.jewelCon.addChild(s)}),this.jewelCon.rotation=this.rotation*t,this.jewelCon.x=f,this.jewelCon.y=b,this.jewelCon.pivot.x=f,this.jewelCon.pivot.y=b,this.game.addChild(this.jewelCon)}add(t){let e=new PIXI.Container,a=new PIXI.Container,i=this.self.createImage(y,{x:698.5,y:58.5});this.pivotCenter(i);let s,n=this.self.createImage(w[t].jewelKey,{x:0,y:0});return this.pivotCenter(n),n.x=i.width/2,n.y=i.height/2,e.addChild(i),s="default"===t?this.self.createImage(w.currentDefault.border,{alpha:0}):this.self.createImage(w[t].border),this.pivotCenter(s),s.x=i.width/2,s.y=i.height/2,i.addChild(n,s),a.addChild(i),a.x=f,a.y=b,a.pivot.x=f,a.pivot.y=b,a}rotate(){let t=store.state.pageNumber,e=this.jewelCon.rotation+this.rotation;v.TweenMax.to(this.jewelCon,.5,{rotation:e});let a=this.jewelCon.children[t].children[0].children[0];v.TweenMax.to(a,.5,{width:.74*a.width,height:.74*a.height});let i=this.jewelCon.children[t+1].children[0],s=i.children[0],n=i.children[1];v.TweenMax.to(s,.5,{width:1.36*s.width,height:1.36*s.height}),v.TweenMax.to(n,.5,{alpha:1}),this.allBorderRotate()}lastJewel(){let{pageNumber:t}=store.state,e=this.jewelCon.children[t].children[0].children[0];v.TweenMax.to(e,.5,{width:.74*e.width,height:.74*e.height})}allBorderRotate(){this.jewelCon.children.forEach(t=>{let e=t.children[0].children[1];e&&v.TweenMax.to(e,1,{rotation:e.rotation+2*Math.PI*8})})}replace(t){let e=store.state.pageNumber,a=this.jewelCon.children[e].children[0];a.answerStatus=t;let i=a.children[0],s=i.x,n=i.y,l=Object(g.getTexture)(w[t].jewelKey);i.texture=l,this.pivotCenter(i),i.x=s,i.y=n;let o=a.children[1],r=o.x,m=o.y;o.texture=Object(g.getTexture)(w[t].border),this.pivotCenter(o),o.x=r,o.y=m}pivotCenter(t){let e=t.width/2,a=t.height/2;t.x+=e,t.y+=a,t.pivot.x=e,t.pivot.y=a}play(t){switch(t){case"right":this.replace("currentRight");break;case"wrong":this.replace("currentWrong");break;case"turn":this.rotate();break;case"lastJewel":this.lastJewel();break;default:console.log("执行默认")}}}const S=781.5,_=529.5;var D=class{constructor(t){this.self=t,this.restTime=null,this.restTimer=null,this.global={wheel:null,jewel:null,animation:{}},this.lastY=-740}exec(){this._init()}_init(){this.dataInit(),this.sceneInit()}dataInit(){let t=store.state.pageNumber,{pageNum:e,restTime:a}=store.state.loadData;store.state.pageNumber=e||t,this.self.restTime=a||parseInt(store.state.answers[store.state.pageNumber].singleTime),0===store.state.pageNumber&&this.self.restTime>3&&(this.self.restTime-=3),store.state.isWaitTurn=!1,store.state.isRight=!1,store.dispatch("clearLoadData")}imageInit(){let t=store.state.pageNumber,e=this.self.game,a=this.self;this.global.wheel=a.createImage("image_wheel",{x:249}),e.addChild(this.global.wheel);let i=new x(a);this.global.jewel=i,i.init(),window.jewel=i;let s=a.createImage("image_optionBg",{x:554.5,y:303});this.global.stemBg=s;let n=store.state.sources[t].optionsData.image;n=a.createImageByRes(n),a.customAnimate(n,"smallToBig",!0),this.global.stemImage=n,e.addChild(s,n),this.global.comeOn=a.createImage("image_comeOn",{x:1205,y:0,alpha:0}),e.addChild(this.global.comeOn)}restTimeInit(){let t=this.self,e=this.self.game,a=new PIXI.Container;a.rotation=-Math.PI/2,a.pivot.x=S,a.pivot.y=_,a.x=S,a.y=_;let i=!0,s=t.restTime,n=t.createImage("image_timeRed",{x:566,y:314}),l=t.createImage("image_timeGreen",{x:566,y:314}),o=s>3?3/s:-1;o>0?a.addChild(n,l):a.addChild(n),e.addChild(a),this.global.timeImage=a;let r=2*Math.PI/(50*s),m=new PIXI.Graphics,d=2*Math.PI;this.restTimer&&clearInterval(this.restTimer),this.restTimer=setInterval(()=>{m.clear(),m.lineStyle(50,16777215),m.arc(S,_,200,d,0,!0),(d-=r)<2*Math.PI*o&&i&&o>0&&(i=!1,a.removeChild(l)),d<0&&(a.removeChild(n),clearInterval(this.restTimer))},20),a.mask=m,a.addChild(m)}animationInit(){let t=this.self,e=this.self.game;this.global.animation.fire=t.createAnimation("animation_xuanze",!1,{alpha:0}),this.global.animation.stick=t.createAnimation("animation_mofabang",!1,{y:this.lastY}),this.stickMove(store.state.currentStudent),this.global.animation.status=t.createAnimation("animation_animation",!1,{alpha:0}),this.global.animation.stick._play("mofabang",!0),e.addChild(this.global.animation.fire,this.global.animation.stick,this.global.animation.status)}sceneInit(){this.imageInit(),this.restTimeInit(),this.animationInit()}stickMove(t){v.TweenMax.to(this.global.animation.stick,.5,{y:350*(t-1)-740})}playRightAnimation(){clearInterval(this.restTimer),store.state.isRight=!0;let{fire:t,stick:e,status:a}=this.global.animation,{pageNumber:i,testNum:s,currentStudent:n}=store.state;t._show(),e._hide(),t._play(`P${n}`,!1,()=>{a._show(),a._play("right",!1,()=>{setTimeout(()=>{this.global.jewel.play("right"),i+1<s?setTimeout(()=>{this.global.jewel.play("turn")},500):this.playFinishAnimation()})}),t._hide(),e._show()})}playFinishAnimation(){let{loadInfo:t,isRight:e}=store.state;store.dispatch("upDateLoadInfo",{answerInfo:e});let a=this.self.game,{status:i,stick:s}=this.global.animation,{jewel:n,stemBg:l,stemImage:o,timeImage:r}=this.global;n.play("lastJewel"),v.TweenMax.to([s,l,o,r],.5,{alpha:0}),void 0===t.find(t=>!1===t)?(a.setChildIndex(i,1),i._play("finish_1")):(a.setChildIndex(i,1),i._play("finish_2"))}playWrongAnimation(){clearInterval(this.restTimer);let{pageNumber:t,testNum:e}=store.state,a=this.global.jewel,i=this.global.animation.status;i._show(),i._play("wrong",!1,()=>{a.play("wrong"),t+1<e?setTimeout(()=>{a.play("turn")},500):this.playFinishAnimation()})}playComeOn(){let t=this.global.comeOn;this.self.game.setChildIndex(t,this.self.game.children.length-1);let e=350*(store.state.currentStudent-1);t._hide(),t.y=e,v.TweenMax.to(t,.5,{alpha:1,onComplete(){setTimeout(()=>{t._hide()},500)}})}turnPage(t){this.lastY=this.global.animation.stick.y,clearInterval(this.restTimer),store.state.pageNumber=t,this.self.newGame(t),this.exec()}};let C,B;var I={name:"start",data:()=>({restTime:10,globalAnimation:"zoomIn",e:{},currentText:""}),methods:{createApp:()=>new s.Application({width:1920,height:1080,autoSize:!0,transparent:!0}),customAnimate(t,e,a,i=.5){let s=t.width,n=t.height,l={};switch(a&&(t.pivot.x=s/t.scale.x/2,t.pivot.y=n/t.scale.y/2,t.x+=s/2,t.y+=n/2),e){case"empty":break;case"smallToBig":t.width=0,t.height=0,l={width:s,height:n};break;case"toBig":t.width=2*s,t.height=2*n,l={width:s,height:n};break;case"fadeOut":l.alpha=0;break;case"lastToNow":let i=t.x;t.x-=92,l={x:i};break;default:console.log("type错误")}return new TweenMax(t,i,l)},createAnimate:(t,e,a=.5)=>new p.a(t,{time:a,type:e,delay:0}),createImage(t,e){let a=Object(g.createSprite)(Object(g.getTexture)(t));if(e)for(var i in e)a[i]=e[i];return a},createImageByRes(t){let e=parseFloat(t.width),a=parseFloat(t.height),i=parseFloat(t.x),s=parseFloat(t.y),n=t.name;return this.createImage(n,{x:i,y:s,width:e,height:a})},createAnimation(t,e,a){let i=Object(g.getAnimation)(t);if(a)for(var s in a)i[s]=a[s];return e&&i.state.setAnimation(e[0],e[1],e[2]),i},createText(t,e){let a;return(a=e.style?new s.Text(t,new s.TextStyle(e.style)):new s.Text(t)).x=e.x?e.x:a.x,a.y=e.y?e.y:a.y,a},addElement(t,e){t&&e&&e.forEach(e=>{t.addChild(e)})},formatTime(){let t="00",e="00";return this.restTime>=0&&(t=this.restTime<60?"00":~~(this.restTime/60)<10?`0${~~(this.restTime/60)}`:~~(this.restTime/60),e=this.restTime%60==0?"00":this.restTime%60<10?`0${this.restTime%60}`:this.restTime%60),{minute:t,second:e}},newGame(t){stage.children.length=0;let e=new u.a(C.sources[t].bgImage,C.sources[t].stemImg,res);stage.addChild(e),this.game=e},addFunction(){PIXI.spine.Spine.prototype.hasOwnProperty("_play")||(PIXI.spine.Spine.prototype._play=function(t,e,a){this.state.setAnimation(0,t,e).listener={complete(){"function"==typeof a&&a()}}}),PIXI.Container.prototype.hasOwnProperty("_show")||(PIXI.Container.prototype._show=function(){this.alpha=1}),PIXI.Container.prototype.hasOwnProperty("_hide")||(PIXI.Container.prototype._hide=function(){this.alpha=0})}},created(){document.getElementsByClassName("page-loading")[0].style.display="none"},destroyed(){PIXI.sound.stopAll(),app.destroy()},mounted(){PIXI.sound.stopAll(),document.getElementsByClassName("page-loading")[0].style.display="none",window.app=this.createApp(),app.view.style.width="19.2rem",app.view.style.height="10.8rem",app.view.id="appCanvas",window.stage=app.stage;const t=this;t.$refs.canvas.appendChild(app.view),stage.interactive=!0;let e=new class{constructor(){}log(t){console.log(t),this.postMsg(t)}postMsg(t){$.ajax({type:"post",url:"https://logstashnrcpb.xueersi.com:5001",contentType:"application/json",data:JSON.stringify(t),success:function(t){console.log(t)},error:function(t){console.log(t,"日志上传失败")}})}};Object(g.load)().then(a=>{console.log("%c资源加载完啦✌️","color:#FF323B;font-weight:bold;"),this.$nextTick(()=>{window.question=a.question.data,C=a.question.data,B=a.question.data,store.state.loadInfo=[],store.state.pageNumber=0,store.state.testNum=6,store.state.sources=C.sources,store.state.testNum=store.state.sources.length,store.state.answers=a.question.data.preFetch.answers,this.addFunction();let i=new D(this);window.init=i;let s=this.createImage("image_startBg"),n=this.createAnimation("animation_daojishi");stage.addChild(s),stage.addChild(n),window.loading={type:"coursewareOnloading",pageNum:0,restTime:3,answerInfo:[],nextStudentNum:1},window.turnPage={type:"coursewareDoing",nextStudentNum:1,score:80,turnToPageNum:3},window.doingLoad={type:"coursewareDoingLoad",turnToPageNum:8,restTime:12,answerInfo:[!0,!0,!0,!0,!0,!0,!0,!0],nextStudentNum:3},window._turnpage=(()=>{window.turnPage.turnToPageNum=store.state.pageNumber+1;let t=Math.random();window.turnPage.nextStudentNum=t<.33?1:t<.66?2:3,window.postMessage(window.turnPage,"*")}),window.comeOn={type:"coursewareComeOn",comeOn:!0},window.parent.postMessage({type:"loadComplete"},"*");window.addEventListener("message",a=>{this.e=a.data;let{type:s,turnToPageNum:l,pageNum:o,restTime:r,nextStudentNum:m,score:d,comeOn:g,answerInfo:c}=a.data;if(this.currentText=store.state.answers[store.state.pageNumber].text,o=parseInt(o),r=parseInt(r),"coursewareOnloading"===s?(store.dispatch("upDateInfo",{answerInfo:c,nextStudentNum:m}),store.state.loadData={pageNum:o,restTime:r},store.state.pageNumber=o,this.currentText=store.state.answers[store.state.pageNumber].text,0===o&&r>3?n.state.setAnimation(0,"animation",!1).listener={complete(){setTimeout(()=>{t.newGame(o),i.exec()})}}:o<store.state.testNum&&o>=0&&(t.newGame(o),i.exec())):"coursewareDoing"===s?store.state.isWaitTurn||(store.state.isWaitTurn=!0,(d=parseInt(d))>=70?i.playRightAnimation():i.playWrongAnimation(),l>=0&&l<store.state.testNum&&(store.state.isWaitTurn=!0,setTimeout(()=>{store.dispatch("upDateInfo",{answerInfo:store.state.isRight,nextStudentNum:m}),i.turnPage(l)},3e3))):"coursewareDoingLoad"===s?l>=0&&l<store.state.testNum&&(store.dispatch("upDateInfo",{answerInfo:c,nextStudentNum:m}),store.state.loadData.restTime=r,store.state.loadData.pageNum=l,store.state.pageNumber=l,i.turnPage(l)):"coursewareComeOn"===s&&g&&i.playComeOn(),"coursewareOnloading"===s||"coursewareDoing"===s||"coursewareDoingLoad"===s||"coursewareComeOn"===s){let{isRight:i,isWaitTurn:s,answerInfo:n,pageNumber:l,answers:o}=store.state,r={logtype:"english_interactive",afterReceiveInfo:{isRight:i,isWaitTurn:s,answerInfo:n,pageNumber:l,restTime:t.restTime},receiveMsg:a.data,currentText:this.currentText,game:"魔法阵"};e.log(r)}}),window.onerror=((a,i,s)=>{let n={emsg:a,eurl:i,eline:s},{isRight:l,isWaitTurn:o,answerInfo:r,pageNumber:m,answers:d}=store.state,g={logtype:"english_interactive",tberr:"course_error",errormsg:n,afterReceiveInfo:{isRight:l,isWaitTurn:o,restTime:t.restTime,answerInfo:r,pageNumber:m},receiveMsg:this.e,currentText:this.currentText,game:"魔法阵"};e.log(g)})})})}},T={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("div",{staticStyle:{fontFamily:"'ArialRoundedMTBold'",visibile:"hidden",width:"0",height:"0"}},[this._v(".")]),this._v(" "),e("div",{ref:"canvas",staticClass:"canvas"}),this._v(" "),e("img",{staticClass:"logo",attrs:{src:"static/images/logo.png",id:"logo"}})])},staticRenderFns:[]};var N=a("C7Lr")(I,T,!1,function(t){a("cWYQ")},null,null).exports,k=a("Gqta");i.default.use(d.a);var A=new d.a({routes:[{path:"/",component:N},{path:"/edit",component:k.a},{path:"/preview",component:k.b}]}),E=a("4gzT"),O=a.n(E),F=(a("JKkS"),a("Otmz")),j=a.n(F),P=a("CtzY"),M=a.n(P);i.default.config.productionTip=!1,i.default.prototype.$http=j.a,i.default.prototype.qs=M.a,i.default.use(O.a),new i.default({el:"#app",router:A,components:{App:m},store:store,template:"<App/>"})},RREg:function(t,e){},UYKw:function(t,e,a){"use strict";var i=a("ghBa"),s=a("cLZ2");let n;var l={name:"App",data:()=>({result:window.store.state.result,question:question,resultUrl:void 0}),computed:{goldnum:(t,e)=>window.store.state.goldnum},methods:{click(){window.parent.postMessage({type:"close"},"*")},createApp:()=>new i.Application({width:1920,height:1080,autoSize:!0,transparent:!0})},mounted(){console.log("解析页");let t=this;if(question.one.end.endBg.image.show&&(this.resultUrl=res[question.one.end.endBg.image.name].url),question.one.end.endBg.animate.show){app.stop(),(n=this.createApp()).view.style.width="19.2rem",n.view.style.height="10.8rem",t.$refs.canvas.appendChild(n.view);let e=n.stage,a=Object(s.a)(question.one.end.endBg.animate.name);a.state.setAnimation(1,"animation",question.one.end.endBg.animate.loop);console.log(e),a.x=question.one.end.endBg.animate.x,a.y=question.one.end.endBg.animate.y,a.scale.set(question.one.gameBgSound.scale),e.addChild(a)}}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"result"},[t.question.one.end.endBg.image.show?a("img",{staticClass:"bg",style:{left:t.question.one.end.endBg.image.x/100+"rem",top:t.question.one.end.endBg.image.y/100+"rem",width:t.question.one.end.endBg.image.width/100+"rem",height:t.question.one.end.endBg.image.height/100+"rem"},attrs:{src:t.resultUrl}}):t._e(),t._v(" "),a("img",{staticClass:"close",attrs:{src:"static/images/close.png"},on:{click:function(e){return t.click()}}}),t._v(" "),a("span",{staticClass:"txt",style:{color:t.question.one.end.goldText.color,left:t.question.one.end.goldText.x/100+"rem",top:t.question.one.end.goldText.y/100+"rem",fontSize:t.question.one.end.goldText.fontSize/100+"rem",fontFamily:t.question.one.end.goldText.fontFamily,fontWeight:t.question.one.end.goldText.fontWeight,fontStyle:t.question.one.end.goldText.fontStyle}},[t._v(t._s(t.goldnum))]),t._v(" "),Array.isArray(t.result)&&0!=t.result.length?a("div",[a("ul",{staticClass:"analysisBox"},t._l(t.result,function(e,i){return a("li",{staticClass:"answer"},[1==e.type||2==e.type?a("div",[a("div",{staticClass:"userAnswer"},[a("span",{staticClass:"noun"},[t._v("("+t._s(i+1)+")\n                    "),t._l(e.useranswer,function(i,s){return a("span",{staticClass:"userAnswerData"},[t._v("\n                        "+t._s(i)),a("img",{directives:[{name:"show",rawName:"v-show",value:i==e.answer[s],expression:"data == item.answer[index]"}],staticClass:"rightImg",attrs:{src:"static/images/right.png"}}),a("img",{directives:[{name:"show",rawName:"v-show",value:i!=e.answer[s],expression:"data != item.answer[index]"}],staticClass:"wrongImg",attrs:{src:"static/images/wrong.png"}})])})],2)]),t._v(" "),a("div",{staticClass:"rightAnswer"},[a("span",{staticClass:"rightTxt"},[t._v("    正确答案:")]),t._v(" "),t._l(e.answer,function(e){return a("span",{staticClass:"right"},[t._v("\n                    "+t._s(e)+"\n                    "),a("span",{staticClass:"break"},[t._v("、")])])})],2)]):t._e(),t._v(" "),0==e.type?a("div",[a("div",{staticClass:"userAnswer"},[a("span",{staticClass:"noun"},[t._v("("+t._s(i+1)+")\n                    "),a("span",{staticClass:"userAnswerData"},[t._v("\n                        "+t._s(e.useranswer)),a("img",{directives:[{name:"show",rawName:"v-show",value:e.useranswer==e.answer,expression:"item.useranswer == item.answer"}],staticClass:"rightImg",attrs:{src:"static/images/right.png"}}),a("img",{directives:[{name:"show",rawName:"v-show",value:e.useranswer!=e.answer,expression:"item.useranswer != item.answer"}],staticClass:"wrongImg",attrs:{src:"static/images/wrong.png"}})])])]),t._v(" "),a("div",{staticClass:"rightAnswer"},[a("span",{staticClass:"rightTxt"},[t._v("    正确答案:")]),t._v(" "),a("span",{staticClass:"right"},[t._v("\n                    "+t._s(e.answer)+"\n                    "),a("span",{staticClass:"break"},[t._v("、")])])])]):t._e()])}),0)]):t._e(),t._v(" "),a("div",{ref:"canvas",staticClass:"canvas"}),t._v(" "),a("audio",{attrs:{autoplay:"autoplay",src:"static/audios/result.mp3"}})])},staticRenderFns:[]};var r=a("C7Lr")(l,o,!1,function(t){a("36zy")},"data-v-adc04332",null);e.a=r.exports},VsuD:function(t,e){},VvSj:function(t,e,a){"use strict";var i=a("bGgH"),s=a.n(i),n=a("ghBa");var l={name:"EditStart",data:()=>({lockImg:"",unLockImg:"",showStatus:!1,startData:null,publicImage:null,maskStatus:!1,label:"1",startBgStatus:!0,startBtnStatus:!0,gameBgSoundData:null,resourceData:null,tabShowStatus:{startBg:!1,startBtn:!1,gameBgAudio:!1}}),props:["allData"],methods:{verifyNumber(t){let e=/^\d*\.+$/g;return isNaN(t)&&(t=0),t=parseFloat(t)>=0?function(t){return/^-?\d*\.\d+$/.test(t)}(parseFloat(t))?parseFloat(t.split(".")[0]+"."+t.split(".")[1].substr(0,1)):e.test(t)?parseFloat(t)+".":t?parseFloat(t):0:0},setElementStatus(t,e,a,i){let s=t+e.substring(0,1).toUpperCase()+e.substring(1),n=window.stage.getChildByName("START").children[0].getChildByName(t+"Container").getChildByName(s),l=this.startData[t][e];if(n)if("scale"===a)o=l[a],/^-?\d*\.\d+$/.test(o)&&(l[a]=parseFloat(l[a].split(".")[0]+"."+l[a].split(".")[1].substr(0,1))),n[a].set(l[a]);else{if(("x"===a||"width"===a)&&l[a]>1920&&"sprite"!=e&&"animate"!=e)return l[a]=parseFloat(n[a]).toFixed(0),this.$message.error("输入数值超出范围 应为0-1920"),!1;if(("y"===a||"height"===a)&&l[a]>1080&&"sprite"!=e&&"animate"!=e)return l[a]=parseFloat(n[a]).toFixed(0),this.$message.error("输入数值超出范围 应为0-1080"),!1;"x"!==a&&"y"!==a&&"width"!==a&&"height"!==a||(l[a]=this.verifyNumber(l[a]),n[a]=l[a]),"width"===a&&l.lock&&(l.height=(l[a]/i).toFixed(0),n.height=l.height),"height"===a&&l.lock&&(l.width=(l[a]*i).toFixed(0),n.width=l.width)}else this.$message({type:"warning",message:"舞台未绑定元素"}),l[a]=0;var o},verifyAnimationFiles(t){let e=[],a=Object.values(t).map((t,e)=>t.name).map(t=>(e.push(t.split(".")[1]),t.split(".")[0])),i=e.sort((t,e)=>t.length-e.length).toString(),s=["png","json","atlas"].toString(),n=a[0];return a.every((t,e)=>n===t)&&i===s},setBgSoundAttr(t,e){let a=window.stage.getChildByName("gameBgSound"),i=this.gameBgSoundData;if(a)if("scale"===e)s=i[e],/^-?\d*\.\d+$/.test(s)&&(i[e]=parseFloat(i[e].split(".")[0]+"."+i[e].split(".")[1].substr(0,1))),a[e].set(i[e]);else{if(("x"===e||"width"===e)&&i[e]>1920&&"sprite"!=t&&"animate"!=t)return i[e]=parseFloat(a[e]).toFixed(0),this.$message.error("输入数值超出范围 应为0-1920"),!1;if(("y"===e||"height"===e)&&i[e]>1080&&"sprite"!=t&&"animate"!=t)return i[e]=parseFloat(a[e]).toFixed(0),this.$message.error("输入数值超出范围 应为0-1080"),!1;"x"!==e&&"y"!==e&&"width"!==e&&"height"!==e||(i[e]=this.verifyNumber(i[e]),a[e]=i[e]),"width"===e&&i.lock&&(i.height=(i[e]/ratio).toFixed(0),a.height=i.height),"height"===e&&i.lock&&(i.width=(i[e]*ratio).toFixed(0),a.width=i.width)}else this.$message({type:"warning",message:"舞台未绑定元素"}),i[e]=0;var s},isFloat:t=>/^-?\d*\.\d+$/.test(t),getJSON(){this.startData=this.allData.one.start,this.gameBgSoundData=this.allData.one.gameBgSound,this.getResourceData(()=>{this.showStatus=!0,this.startData.startBtn.image.show?this.label="1":this.startData.startBtn.animate.show?this.label="2":this.startData.startBtn.sprite.show?this.label="3":this.label="1"})},setResource(t,e){if(this.startData[t][e].show){let a=t+e.substring(0,1).toUpperCase()+e.substring(1),i=window.stage.getChildByName("START").children[0].getChildByName(t+"Container").getChildByName(a);i&&(i.visible=!0)}else{this.startData[t][e].name="",this.startData[t][e].width&&(this.startData[t][e].width=0),this.startData[t][e].height&&(this.startData[t][e].height=0),this.startData[t][e].x&&(this.startData[t][e].x=0),this.startData[t][e].y&&(this.startData[t][e].y=0),this.startData[t][e].scale&&(this.startData[t][e].scale=1);let a=t+e.substring(0,1).toUpperCase()+e.substring(1),i=window.stage.getChildByName("START").children[0].getChildByName(t+"Container").getChildByName(a),s=window.stage.getChildByName("START").children[0].getChildByName(t+"Container");i&&s.removeChild(i)}},getResourceData(t){this.$http.get("/getResourceJSON",{params:{}}).then(e=>{this.resourceData=e,this.lockImg=this.resourceData.image_lock_on,this.unLockImg=this.resourceData.image_lock_off,t&&t()})},startBtn(t){Object.values(this.startData.startBtn).forEach(t=>{t.show=!1,t.name="",t.x&&(t.x=0),t.y&&(t.y=0),t.width&&(t.width=0),t.height&&(t.height=0),t.scale&&(t.scale=1)}),window.stage.getChildByName("START").children[0].getChildByName("startBtnContainer").removeChildren(),this.startData.startBtn[t].show=!0},setbgAudioStatus(){this.gameBgSoundData.show?this.tabShowStatus.gameBgAudio=!0:(window.stage.getChildByName("gameBgSound")&&window.stage.removeChild(window.stage.getChildByName("gameBgSound")),this.gameBgSoundData.audio="",this.gameBgSoundData.animate_name="",this.gameBgSoundData.x=0,this.gameBgSoundData.y=0,this.tabShowStatus.gameBgAudio=!1)},tabShow(t,e){let a=this.$refs[e];this.tabShowStatus[t]?(this.tabShowStatus[t]=!1,a.className="el-icon-arrow-right"):(Object.keys(this.tabShowStatus).forEach((t,e)=>{this.tabShowStatus[t]=!1}),this.tabShowStatus[t]=!0,a.className="el-icon-arrow-down",this.gameBgSoundData.show||(this.tabShowStatus.gameBgAudio=!1,a.className="el-icon-arrow-right"))},uploadImage(t,e,a){let i=a.target.files[0].name.split(".")[a.target.files[0].name.split(".").length-1];return-1===["jpg","png"].indexOf(i)?(this.$message({message:"上传类型不符",type:"error"}),void(a.target.value="")):0===a.target.files.length?(this.$message({message:"上传文件个数不符合",type:"warning"}),void(a.target.value="")):a.target.files[0].size/1024/1024>1?(this.$message({message:"上传文件大小在1M以内",type:"warning"}),void(a.target.value="")):void this.$http.post("/uploadingImage",{image:a.target.files[0]},{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{this.startData[t][e].name=i.resourceName,this.getResourceData();let l=t+e.substring(0,1).toUpperCase()+e.substring(1),o=window.stage.getChildByName("START").children[0].getChildByName(t+"Container").getChildByName(l),r=window.stage.getChildByName("START").children[0].getChildByName(t+"Container");o?(o.texture=new n.Texture.fromImage(i.path),"startBg"!==t&&new s.a(o,(a,i)=>{this.startData[t][e].x=a.toFixed(1),this.startData[t][e].y=i.toFixed(1)}),this.startData[t][e].show?o.visible=!0:o.visible=!1):((o=new n.Sprite.fromImage(i.path)).name=l,o.x=0,o.y=0,r.addChild(o),"startBg"!==t&&new s.a(o,(a,i)=>{this.startData[t][e].x=a.toFixed(1),this.startData[t][e].y=i.toFixed(1)}),this.startData[t][e].show?o.visible=!0:o.visible=!1),"startBg"!==t&&(this.startData[t][e].width=i.width,this.startData[t][e].height=i.height,this.startData[t][e].x?this.startData[t][e].x=this.startData[t][e].x:this.startData[t][e].x=0,this.startData[t][e].y?this.startData[t][e].y=this.startData[t][e].y:this.startData[t][e].y=0),o.width=i.width,o.height=i.height,a.target.value=""})},verifySpriteFiles(t){let e=[],a=Object.values(t).map((t,e)=>t.name).map(t=>(e.push(t.split(".")[1]),t.split(".")[0])),i=e.sort((t,e)=>t.length-e.length).toString(),s=["png","json"].toString(),n=a[0];return a.every((t,e)=>n===t)&&i===s},uploadAnimation(t,e){if(0===e.target.files.length||3!==e.target.files.length)return this.$message({message:"上传文件个数不符合",type:"warning"}),void(e.target.value="");if(!this.verifyAnimationFiles(e.target.files))return this.$message({message:"上传文件不符合",type:"warning"}),void(e.target.value="");let a={};Object.values(e.target.files).forEach((t,e)=>{a["animation"+(e+1)]=t}),this.$http.post("/uploadingAnimation",a,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{if(console.log(a.path),e.target.value="","gameBgAudio"===t){this.gameBgSoundData.animate_name=a.resourceName,this.gameBgSoundData.scale=1;let t,e=window.stage;if(window.stage.getChildByName("gameBgSound")){let i=(t=window.stage.getChildByName("gameBgSound")).x,n=t.y;e.removeChild(t);let l=(new Date).getTime();PIXI.loader.add("animation"+l,a.path),PIXI.loader.load((a,o)=>{(t=new PIXI.spine.Spine(o["animation"+l].spineData)).x=i,t.y=n,t.name="gameBgSound",t.state.setAnimation(1,"animation",!0),e.addChild(t),e.setChildIndex(t,e.children.length-1),new s.a(t,(t,e)=>{this.gameBgSoundData.x=t.toFixed(1),this.gameBgSoundData.y=e.toFixed(1)})}),this.allData.one.gameBgSound.show&&this.allData.one.gameBgSound.audio?t&&(t.visible=!0):t&&(t.visible=!1)}else{this.gameBgSoundData.x=0,this.gameBgSoundData.y=0;let i=(new Date).getTime();PIXI.loader.add("animation"+i,a.path),PIXI.loader.load((a,n)=>{(t=new PIXI.spine.Spine(n["animation"+i].spineData)).name="gameBgSound",t.x=0,t.y=0,t.state.setAnimation(1,"animation",!0),e.addChild(t),e.setChildIndex(t,e.children.length-1),new s.a(t,(t,e)=>{this.gameBgSoundData.x=t.toFixed(1),this.gameBgSoundData.y=e.toFixed(1)}),this.allData.one.gameBgSound.show&&this.allData.one.gameBgSound.audio?t&&(t.visible=!0):t&&(t.visible=!1)})}}else{this.startData[t].animate.name=a.resourceName;let e=t+"Animate",i=window.stage.getChildByName("START").children[0].getChildByName(t+"Container").getChildByName(e),n=window.stage.getChildByName("START").children[0].getChildByName(t+"Container");if(i){let l=i.x,o=i.y;n.removeChild(i);let r=(new Date).getTime();PIXI.loader.add("animation"+r,a.path),PIXI.loader.load((a,m)=>{(i=new PIXI.spine.Spine(m["animation"+r].spineData)).x=l,i.y=o,i.scale.set(this.startData[t].animate.scale),i.name=e,i.state.setAnimation(1,"animation",!0),n.addChild(i),new s.a(i,(e,a)=>{this.startData[t].animate.x=e.toFixed(1),this.startData[t].animate.y=a.toFixed(1)}),this.startData[t].animate.show?i&&(i.visible=!0):i&&(i.visible=!1)})}else{this.startData[t].animate.x=0,this.startData[t].animate.y=0;let l=(new Date).getTime();PIXI.loader.add("animation"+l,a.path),PIXI.loader.load((a,o)=>{(i=new PIXI.spine.Spine(o["animation"+l].spineData)).x=0,i.y=0,i.scale.set(this.startData[t].animate.scale),i.name=e,i.state.setAnimation(1,"animation",!0),n.addChild(i),new s.a(i,(e,a)=>{this.startData[t].animate.x=e.toFixed(1),this.startData[t].animate.y=a.toFixed(1)}),this.startData[t].animate.show?i&&(i.visible=!0):i&&(i.visible=!1)})}}})},uploadSprite(t,e){if(0===e.target.files.length||2!==e.target.files.length)return this.$message({message:"上传文件个数不符合",type:"warning"}),void(e.target.value="");if(!this.verifySpriteFiles(e.target.files))return this.$message({message:"上传文件不符合",type:"warning"}),void(e.target.value="");let a={};Object.values(e.target.files).forEach((t,e)=>{a["sprite"+(e+1)]=t}),console.log(a),this.$http.post("/uploadingSprite",a,{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{e.target.value="";this.startData[t].sprite.name=a.resourceName;let i=t+"Sprite",n=window.stage.getChildByName("START").children[0].getChildByName(t+"Container").getChildByName(i),l=window.stage.getChildByName("START").children[0].getChildByName(t+"Container");if(n){let e=n.x,o=n.y;l.removeChild(n);let r=(new Date).getTime();console.log(r),PIXI.loader.add("sprite"+r,a.path),PIXI.loader.load((a,m)=>{let d=m["sprite"+r].spritesheet,g=[];for(let t in d.textures)g.push(d.textures[t]);(n=new PIXI.extras.AnimatedSprite(g)).x=e,n.y=o,n.scale.set(this.startData[t].sprite.scale),n.animationSpeed=1,n.play(),n.name=i,l.addChild(n),new s.a(n,(e,a)=>{this.startData[t].sprite.x=e.toFixed(1),this.startData[t].sprite.y=a.toFixed(1)}),this.startData[t].sprite.show?n&&(n.visible=!0):n&&(n.visible=!1)})}else{this.startData[t].sprite.x=0,this.startData[t].sprite.y=0;let e=(new Date).getTime();PIXI.loader.add("sprite"+e,a.path),PIXI.loader.load((a,o)=>{let r=o["sprite"+e].spritesheet,m=[];for(let t in r.textures)m.push(r.textures[t]);(n=new PIXI.extras.AnimatedSprite(m)).x=0,n.y=0,n.scale.set(this.startData[t].sprite.scale),n.animationSpeed=1,n.play(),n.name=i,l.addChild(n),new s.a(n,(e,a)=>{this.startData[t].sprite.x=e.toFixed(1),this.startData[t].sprite.y=a.toFixed(1)}),this.startData[t].sprite.show?n&&(n.visible=!0):n&&(n.visible=!1)})}})},uploadAudio(t){let e=t.target.files[0].name.split(".")[t.target.files[0].name.split(".").length-1];return-1===["mp3","wav"].indexOf(e)?(this.$message({message:"上传类型不符",type:"error"}),void(t.target.value="")):0===t.target.files.length?(this.$message({message:"上传文件个数不符合",type:"warning"}),void(t.target.value="")):void this.$http.post("/uploadingAudio",{audio:t.target.files[0]},{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{t.target.value="",this.gameBgSoundData.audio=e.resourceName;let a=stage.getChildByName("gameBgSound");this.allData.one.gameBgSound.show&&this.allData.one.gameBgSound.animate_name?a&&(a.visible=!0):a&&(a.visible=!1)})},showBigImage(t){this.maskStatus=!0,this.publicImage=t.target.src},controlStartPage(t){let e=stage.getChildByName("gameBgSound"),a=stage.getChildByName("START");t?(e&&(e.visible=!0),a&&(a.visible=!0)):(e&&(e.visible=!1),a&&(a.visible=!1))},lockStatusData(t,e){if(t.image.show&&t.image.name){if(!t.image.width||!t.image.height)return void this.$message.error("绑定对象的宽高都不可为空");t.image.lock?(e.currentTarget.setAttribute("data-lock","false"),t.image.ratio=0,t.image.lock=!1):(e.currentTarget.setAttribute("data-lock","true"),t.image.ratio=parseFloat(t.image.width)/parseFloat(t.image.height),t.image.lock=!0)}else this.$message({type:"warning",message:"舞台未绑定元素!"})}},mounted(){this.getJSON(),this.controlStartPage(this.startData.show)}},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.showStatus?a("div",{staticClass:"start"},[a("el-switch",{staticStyle:{"margin-left":"15px"},attrs:{"active-color":"#77DC04","active-text":"是否应用","inactive-color":"#ff4949"},on:{change:function(e){return t.controlStartPage(t.startData.show)}},model:{value:t.startData.show,callback:function(e){t.$set(t.startData,"show",e)},expression:"startData.show"}}),t._v(" "),t.startData.show?a("div",{staticStyle:{"margin-top":"8px"}},[a("div",{staticClass:"start-title"},[a("i",{ref:"startBgTitle",class:t.tabShowStatus.startBg?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow("startBg","startBgTitle")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow("startBg","startBgTitle")}}},[t._v("\n                背景图\n            ")])]),t._v(" "),t.tabShowStatus.startBg?a("div",{staticClass:"start-inner"},[a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource("startBg","image")}},model:{value:t.startData.startBg.image.show,callback:function(e){t.$set(t.startData.startBg.image,"show",e)},expression:"startData.startBg.image.show"}},[t._v("图片")])],1),t._v(" "),a("div",{staticClass:"upload"},[a("div",{staticClass:"img-box"},[a("img",{attrs:{src:t.resourceData[t.startData.startBg.image.name],alt:"",width:"131",height:"96"},on:{click:function(e){return t.showBigImage(e)}}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改图片")]),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){return t.uploadImage("startBg","image",e)}}})])])]),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource("startBg","sprite")}},model:{value:t.startData.startBg.sprite.show,callback:function(e){t.$set(t.startData.startBg.sprite,"show",e)},expression:"startData.startBg.sprite.show"}},[t._v("精灵序列图")])],1),t._v(" "),a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("\n                    精灵文件：\n                ")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.startData.startBg.sprite.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadSprite("startBg",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBg","sprite","x")}},model:{value:t.startData.startBg.sprite.x,callback:function(e){t.$set(t.startData.startBg.sprite,"x",e)},expression:"startData.startBg.sprite.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBg","sprite","y")}},model:{value:t.startData.startBg.sprite.y,callback:function(e){t.$set(t.startData.startBg.sprite,"y",e)},expression:"startData.startBg.sprite.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBg","sprite","scale")}},model:{value:t.startData.startBg.sprite.scale,callback:function(e){t.$set(t.startData.startBg.sprite,"scale",e)},expression:"startData.startBg.sprite.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.startData.startBg.sprite.loop,callback:function(e){t.$set(t.startData.startBg.sprite,"loop",e)},expression:"startData.startBg.sprite.loop"}})],1),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource("startBg","animate")}},model:{value:t.startData.startBg.animate.show,callback:function(e){t.$set(t.startData.startBg.animate,"show",e)},expression:"startData.startBg.animate.show"}},[t._v("动画")])],1),t._v(" "),a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("动画文件：")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.startData.startBg.animate.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadAnimation("startBg",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBg","animate","x")}},model:{value:t.startData.startBg.animate.x,callback:function(e){t.$set(t.startData.startBg.animate,"x",e)},expression:"startData.startBg.animate.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBg","animate","y")}},model:{value:t.startData.startBg.animate.y,callback:function(e){t.$set(t.startData.startBg.animate,"y",e)},expression:"startData.startBg.animate.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBg","animate","scale")}},model:{value:t.startData.startBg.animate.scale,callback:function(e){t.$set(t.startData.startBg.animate,"scale",e)},expression:"startData.startBg.animate.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.startData.startBg.animate.loop,callback:function(e){t.$set(t.startData.startBg.animate,"loop",e)},expression:"startData.startBg.animate.loop"}})],1)],1):t._e(),t._v(" "),a("div",{staticClass:"start-title"},[a("i",{ref:"startBtnTitle",class:t.tabShowStatus.startBtn?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow("startBtn","startBtnTitle")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow("startBtn","startBtnTitle")}}},[t._v("\n                开始按钮\n            ")])]),t._v(" "),t.tabShowStatus.startBtn?a("div",{staticClass:"start-inner"},[a("div",{staticClass:"edit-radio-title"},[a("el-radio",{attrs:{label:"1"},on:{change:function(e){return t.startBtn("image")}},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}},[t._v("图片")]),t._v(" "),a("el-radio",{attrs:{label:"2"},on:{change:function(e){return t.startBtn("animate")}},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}},[t._v("动画")]),t._v(" "),a("el-radio",{attrs:{label:"3"},on:{change:function(e){return t.startBtn("sprite")}},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}},[t._v("精灵序列")])],1),t._v(" "),"1"===t.label?a("div",[a("div",{staticClass:"upload"},[a("div",{staticClass:"img-box"},[a("img",{attrs:{src:t.resourceData[t.startData.startBtn.image.name],alt:"",width:"131",height:"96"},on:{click:function(e){return t.showBigImage(e)}}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改图片")]),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){return t.uploadImage("startBtn","image",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","image","x")}},model:{value:t.startData.startBtn.image.x,callback:function(e){t.$set(t.startData.startBtn.image,"x",e)},expression:"startData.startBtn.image.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","image","y")}},model:{value:t.startData.startBtn.image.y,callback:function(e){t.$set(t.startData.startBtn.image,"y",e)},expression:"startData.startBtn.image.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("div",{staticClass:"lockStatus"},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","image","width",t.startData.startBtn.image.ratio)}},model:{value:t.startData.startBtn.image.width,callback:function(e){t.$set(t.startData.startBtn.image,"width",e)},expression:"startData.startBtn.image.width"}},[a("template",{slot:"prepend"},[t._v("W：")])],2),t._v(" "),a("span",{staticClass:"lock_block",attrs:{lockRatio:t.startData.startBtn.image.ratio}},[a("img",{attrs:{src:t.startData.startBtn.image.lock?t.lockImg:t.unLockImg,"data-lock":"false",alt:""},on:{click:function(e){return t.lockStatusData(t.startData.startBtn,e)}}})]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","image","height",t.startData.startBtn.image.ratio)}},model:{value:t.startData.startBtn.image.height,callback:function(e){t.$set(t.startData.startBtn.image,"height",e)},expression:"startData.startBtn.image.height"}},[a("template",{slot:"prepend"},[t._v("H：")])],2)],1)],1):t._e(),t._v(" "),"2"===t.label?a("div",[a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("动画文件：")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.startData.startBtn.animate.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadAnimation("startBtn",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","animate","x")}},model:{value:t.startData.startBtn.animate.x,callback:function(e){t.$set(t.startData.startBtn.animate,"x",e)},expression:"startData.startBtn.animate.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","animate","y")}},model:{value:t.startData.startBtn.animate.y,callback:function(e){t.$set(t.startData.startBtn.animate,"y",e)},expression:"startData.startBtn.animate.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","animate","scale")}},model:{value:t.startData.startBtn.animate.scale,callback:function(e){t.$set(t.startData.startBtn.animate,"scale",e)},expression:"startData.startBtn.animate.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.startData.startBtn.animate.loop,callback:function(e){t.$set(t.startData.startBtn.animate,"loop",e)},expression:"startData.startBtn.animate.loop"}})],1)],1):t._e(),t._v(" "),"3"===t.label?a("div",[a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("\n                        精灵文件：\n                    ")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.startData.startBtn.sprite.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadSprite("startBtn",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","sprite","x")}},model:{value:t.startData.startBtn.sprite.x,callback:function(e){t.$set(t.startData.startBtn.sprite,"x",e)},expression:"startData.startBtn.sprite.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","sprite","y")}},model:{value:t.startData.startBtn.sprite.y,callback:function(e){t.$set(t.startData.startBtn.sprite,"y",e)},expression:"startData.startBtn.sprite.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus("startBtn","sprite","scale")}},model:{value:t.startData.startBtn.sprite.scale,callback:function(e){t.$set(t.startData.startBtn.sprite,"scale",e)},expression:"startData.startBtn.sprite.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.startData.startBtn.sprite.loop,callback:function(e){t.$set(t.startData.startBtn.sprite,"loop",e)},expression:"startData.startBtn.sprite.loop"}})],1)],1):t._e()]):t._e(),t._v(" "),a("div",{staticClass:"start-title"},[a("i",{ref:"gameBgAudioTitle",class:t.tabShowStatus.gameBgAudio?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow("gameBgAudio","gameBgAudioTitle")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow("gameBgAudio","gameBgAudioTitle")}}},[t._v("\n                背景音乐\n            ")]),t._v(" "),a("el-switch",{staticClass:"edit-title-switch",attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},on:{change:function(e){return t.setbgAudioStatus()}},model:{value:t.gameBgSoundData.show,callback:function(e){t.$set(t.gameBgSoundData,"show",e)},expression:"gameBgSoundData.show"}})],1),t._v(" "),t.tabShowStatus.gameBgAudio&&!0===t.gameBgSoundData.show?a("div",{staticClass:"start-inner"},[a("div",{staticClass:"bg-audio-title"},[t._v("\n                音频\n            ")]),t._v(" "),a("div",{staticClass:"bg-audio-inner"},[a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("音频文件：")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.gameBgSoundData.audio)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){return t.uploadAudio(e)}}})])])]),t._v(" "),a("div",{staticClass:"edit-range-audio"},[a("span",[t._v("音量：")]),t._v(" "),a("el-slider",{attrs:{min:Number(0),max:Number(1),step:Number(.1)},model:{value:t.gameBgSoundData.audioVolume,callback:function(e){t.$set(t.gameBgSoundData,"audioVolume",e)},expression:"gameBgSoundData.audioVolume"}})],1),t._v(" "),a("div",{staticClass:"edit-switch-audio"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.gameBgSoundData.loop,callback:function(e){t.$set(t.gameBgSoundData,"loop",e)},expression:"gameBgSoundData.loop"}})],1)]),t._v(" "),a("div",{staticClass:"bg-audio-title"},[t._v("\n                图标动画\n            ")]),t._v(" "),a("div",{staticClass:"bg-audio-inner"},[a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("动画文件：")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.gameBgSoundData.animate_name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadAnimation("gameBgAudio",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setBgSoundAttr("animate","x")}},model:{value:t.gameBgSoundData.x,callback:function(e){t.$set(t.gameBgSoundData,"x",e)},expression:"gameBgSoundData.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setBgSoundAttr("animate","y")}},model:{value:t.gameBgSoundData.y,callback:function(e){t.$set(t.gameBgSoundData,"y",e)},expression:"gameBgSoundData.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setBgSoundAttr("animate","scale")}},model:{value:t.gameBgSoundData.scale,callback:function(e){t.$set(t.gameBgSoundData,"scale",e)},expression:"gameBgSoundData.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2)],1)]):t._e()]):t._e(),t._v(" "),t.maskStatus?a("div",{staticClass:"mask",on:{click:function(e){t.maskStatus=!1}}},[a("img",{attrs:{src:t.publicImage,alt:""}})]):t._e()],1):t._e()},staticRenderFns:[]};var r=a("C7Lr")(l,o,!1,function(t){a("1KYS")},"data-v-ae69fac0",null).exports,m={name:"EditGamePublic",data(){return{lockImg:this.resourceData.image_lock_on,unLockImg:this.resourceData.image_lock_off,fontFamily:[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:"SimSun"},{label:"黑体",value:"SimHei"},{label:"方正粗圆",value:"FZCuYuan-M03S"},{label:"方正粗圆简",value:"FZZhunYuan-M02S"}],textAlign:[{label:"左对齐",value:"left"},{label:"右对齐",value:"right"},{label:"居中对齐",value:"center"},{label:"两端对齐",value:"justify"}]}},props:["allData","gameData","resourceData","tabShowStatus","item","index"],methods:{verifyNumber(t){let e=/^\d*\.+$/g;return isNaN(t)&&(t=0),t=parseFloat(t)>=0?function(t){return/^-?\d*\.\d+$/.test(t)}(parseFloat(t))?parseFloat(t.split(".")[0]+"."+t.split(".")[1].substr(0,1)):e.test(t)?parseFloat(t)+".":t?parseFloat(t):0:0},setElementStatus(t,e,a,i,s){let n="",l=(n="bgImage"===e?"gameBg":"stem")+a.substring(0,1).toUpperCase()+a.substring(1),o=window.stage.getChildByName("GAME").getChildByName("GAME"+t).children[0].getChildByName(n+"Container").getChildByName(l),r=this.gameData[t][e][a];if(o)if("scale"===i)m=r[i],/^-?\d*\.\d+$/.test(m)&&(r[i]=parseFloat(r[i].split(".")[0]+"."+r[i].split(".")[1].substr(0,1))),o[i].set(r[i]);else{if(("x"===i||"width"===i)&&r[i]>1920&&"sprite"!=a&&"animate"!=a)return r[i]=parseFloat(o[i]).toFixed(0),this.$message.error("输入数值超出范围 应为0-1920"),!1;if(("y"===i||"height"===i)&&r[i]>1080&&"sprite"!=a&&"animate"!=a)return r[i]=parseFloat(o[i]).toFixed(0),this.$message.error("输入数值超出范围 应为0-1080"),!1;"x"!==i&&"y"!==i&&"width"!==i&&"height"!==i||(r[i]=this.verifyNumber(r[i]),o[i]=r[i]),"width"===i&&r.lock&&(r.height=(r[i]/s).toFixed(0),o.height=r.height),"height"===i&&r.lock&&(r.width=(r[i]*s).toFixed(0),o.width=r.width)}else this.$message({type:"warning",message:"舞台未绑定元素"}),r[i]=0;var m},setSubTitileAttr(t,e){let a="";a="soundImg"===t?"stemSound":"stemText";let i=window.stage.getChildByName("GAME").getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].getChildByName(a);if(i){if("x"===e&&this.item.subTitle[t][e]>1920)return this.$message.error("输入数值超出范围 应为0-1920"),void(this.item.subTitle[t][e]=i[e]);if("y"===e&this.item.subTitle[t][e]>1080)return this.$message.error("输入数值超出范围 应为0-1080"),void(this.item.subTitle[t][e]=i[e]);if(this.isFloat(parseFloat(this.item.subTitle[t][e])))this.item.subTitle[t][e]=parseFloat(this.item.subTitle[t][e].split(".")[0]+"."+this.item.subTitle[t][e].split(".")[1].substr(0,1));else{this.item.subTitle[t][e];this.item.subTitle[t][e]&&/^\d*\.+$/g.test(this.item.subTitle[t][e])?this.item.subTitle[t][e]=parseFloat(this.item.subTitle[t][e])+".":this.item.subTitle[t][e]=this.item.subTitle[t][e]?parseFloat(this.item.subTitle[t][e]):0}parseFloat(this.item.subTitle[t][e])<0&&(this.item.subTitle[t][e]=i[e]),i[e]=this.item.subTitle[t][e]}},setStemTextStatus(t){let e=window.stage.getChildByName("GAME").getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].getChildByName("stemText");e&&(e.visible=!!t)},setStemText(t){let e=this.item.subTitle,a=window.stage.getChildByName("GAME"),i=a.getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].getChildByName("stemText"),l=/^\d{1,3}$/;if("letterSpacing"!==t&&"lineHeight"!==t||(l=/^0?-\d?\.?\d?$/),"width"===t&&(e.stem[t]>1920||e.stem[t]<0))return e.stem.width=i._style.wordWrapWidth,void this.$message.error("输入数值超出范围 应为0-1920");if("fontSize"==t)if(0==e.stem[t]){if(i)return void(i.visible=!1)}else i&&(i.visible=!0);if("fontSize"==t){if(!l.test(e.stem[t]))return void this.$message({type:"error",message:"输入错误"});e.stem[t]>120&&(e.stem[t]=120,this.$message({type:"warning",message:"超过最大字体120"}))}"lineHeight"!=t&&"letterSpacing"!=t||(l.test(e.stem[t])?e.stem[t]=parseFloat(e.stem[t])?parseFloat(e.stem[t]).toFixed(0):"-":e.stem[t]=parseFloat(e.stem[t])?parseFloat(e.stem[t]).toFixed(0):0),"width"==t&&(e.stem[t]=this.verifyNumber(e.stem[t])),e.stem.color=e.stem.color?e.stem.color:"#000";let o=new PIXI.TextStyle({fontFamily:e.stem.fontFamily,fontSize:parseInt(e.stem.fontSize),wordWrap:!0,wordWrapWidth:parseInt(e.stem.width),breakWords:!0,lineHeight:parseInt(e.stem.lineHeight),letterSpacing:parseInt(e.stem.letterSpacing),align:e.stem.textAlign,fill:e.stem.color,width:e.stem.width,fontWeight:e.stem.strong?"bold":"",fontStyle:e.stem.italic?"italic":"",padding:40});if(i){if("text"===t)return void i.setText(e.stem.text);i.setStyle(o),e.stem.show?i.visible=!0:i.visible=!1}else{let t=new n.Text(e.stem.text,o);new s.a(t,(t,e)=>{this.item.subTitle.stem.x=t.toFixed(1),this.item.subTitle.stem.y=e.toFixed(1)}),t.name="stemText",console.log(t),a.getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].addChild(t),e.stem.show?t.visible=!0:t.visible=!1}},setResource(t,e,a){if("subTitle"===e)if(this.gameData[t][e].audioShow){let a="";a="bgImage"===e?"gameBg":"stem";let i=window.stage.getChildByName("GAME").getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].getChildByName("stemSound");i&&this.gameData[t][e].audio&&(i.visible=!0)}else{this.gameData[t][e].audio="",this.gameData[t][e].soundImg.animate_name="",this.gameData[t][e].soundImg.x&&(this.gameData[t][e].soundImg.x=0),this.gameData[t][e].soundImg.y&&(this.gameData[t][e].soundImg.y=0),this.gameData[t][e].soundImg.width&&(this.gameData[t][e].soundImg.width=0),this.gameData[t][e].soundImg.height&&(this.gameData[t][e].soundImg.height=0),this.gameData[t][e].soundImg.scale&&(this.gameData[t][e].soundImg.scale=1);let a=window.stage.getChildByName("GAME"),i=a.getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0],s=a.getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].getChildByName("stemSound");s&&i.removeChild(s)}else if(this.gameData[t][e][a].show){let i="";i="bgImage"===e?"gameBg":"stem";let s=window.stage.getChildByName("GAME"),n=i+a.substring(0,1).toUpperCase()+a.substring(1),l=s.getChildByName("GAME"+t).children[0].getChildByName(i+"Container").getChildByName(n);l&&(l.visible=!0)}else{this.gameData[t][e][a].name="",this.gameData[t][e][a].x&&(this.gameData[t][e][a].x=0),this.gameData[t][e][a].y&&(this.gameData[t][e][a].y=0),this.gameData[t][e][a].width&&(this.gameData[t][e][a].width=0),this.gameData[t][e][a].height&&(this.gameData[t][e][a].height=0),this.gameData[t][e][a].scale&&(this.gameData[t][e][a].scale=1);let i="";i="bgImage"===e?"gameBg":"stem";let s=window.stage.getChildByName("GAME"),n=i+a.substring(0,1).toUpperCase()+a.substring(1),l=s.getChildByName("GAME"+t).children[0].getChildByName(i+"Container").getChildByName(n),o=s.getChildByName("GAME"+t).children[0].getChildByName(i+"Container");l&&o.removeChild(l)}},tabShow(t,e){let a=this.$refs[e+"Title"];this.tabShowStatus[t].child[e]?(this.tabShowStatus[t].child[e]=!1,a.className="el-icon-arrow-right"):(Object.keys(this.tabShowStatus[t].child).forEach((e,a)=>{this.tabShowStatus[t].child[e]=!1}),this.tabShowStatus[t].child[e]=!0,a.className="el-icon-arrow-down")},setGoldTextFontStyle(t,e){this.gameData[e].subTitle.stem[t]=!this.gameData[e].subTitle.stem[t];let a=this.item.subTitle,i=window.stage.getChildByName("GAME").getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].getChildByName("stemText");if(i){let t=new PIXI.TextStyle({fontFamily:a.stem.fontFamily,fontSize:parseInt(a.stem.fontSize),wordWrap:!0,wordWrapWidth:parseInt(a.stem.width),breakWords:!0,lineHeight:parseInt(a.stem.lineHeight),letterSpacing:parseInt(a.stem.letterSpacing),align:a.stem.textAlign,fill:a.stem.color,width:a.stem.width,fontWeight:a.stem.strong?"bold":"",fontStyle:a.stem.italic?"italic":"",padding:40});i.setStyle(t)}},isFloat:t=>/^-?\d*\.\d+$/.test(t),uploadImage(t,e,a){let i=a.target.files[0].name.split(".")[a.target.files[0].name.split(".").length-1];return-1===["jpg","png","JPG"].indexOf(i)?(this.$message({message:"上传类型不符",type:"error"}),void(a.target.value="")):0===a.target.files.length?(this.$message({message:"上传文件个数不符合",type:"warning"}),void(a.target.value="")):a.target.files[0].size/1024/1024>1?(this.$message({message:"上传文件大小在1M以内",type:"warning"}),void(a.target.value="")):void this.$http.post("/uploadingImage",{image:a.target.files[0]},{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{this.gameData[t][e].image.name=i.resourceName,this.updateResourceData();let l="";l="bgImage"===e?"gameBg":"stem";let o=window.stage.getChildByName("GAME"),r=l+"Image".substring(0,1).toUpperCase()+"Image".substring(1),m=o.getChildByName("GAME"+t).children[0].getChildByName(l+"Container").getChildByName(r),d=o.getChildByName("GAME"+t).children[0].getChildByName(l+"Container");m?(PIXI.loader.add(i.resourceName,i.path),PIXI.loader.load((a,l)=>{m.texture=new n.Texture.fromImage(l[i.resourceName].url),m.width=i.width,m.height=i.height,"bgImage"!==e&&new s.a(m,(a,i)=>{this.gameData[t][e].image.x=a.toFixed(1),this.gameData[t][e].image.y=i.toFixed(1)}),this.gameData[t][e].image.show?m.visible=!0:m.visible=!1})):(this.gameData[t][e].image.x=0,this.gameData[t][e].image.y=0,PIXI.loader.add(i.resourceName,i.path),PIXI.loader.load((a,l)=>{(m=new n.Sprite.fromImage(l[i.resourceName].url)).name=r,m.x=0,m.y=0,m.width=i.width,m.height=i.height,d.addChild(m),"bgImage"!==e&&new s.a(m,(a,i)=>{this.gameData[t][e].image.x=a.toFixed(1),this.gameData[t][e].image.y=i.toFixed(1)}),this.gameData[t][e].image.show?m.visible=!0:m.visible=!1})),"bgImage"!==e&&(this.gameData[t][e].image.width=i.width,this.gameData[t][e].image.height=i.height),a.target.value=""})},verifySpriteFiles(t){let e=[],a=Object.values(t).map((t,e)=>t.name).map(t=>(e.push(t.split(".")[1]),t.split(".")[0])),i=e.sort((t,e)=>t.length-e.length).toString(),s=["png","json"].toString(),n=a[0];return a.every((t,e)=>n===t)&&i===s},uploadSprite(t,e,a){if(0===a.target.files.length||2!==a.target.files.length)return this.$message({message:"上传文件个数不符合",type:"warning"}),void(a.target.value="");if(!this.verifySpriteFiles(a.target.files))return this.$message({message:"上传文件不符合",type:"warning"}),void(a.target.value="");let i={};Object.values(a.target.files).forEach((t,e)=>{i["sprite"+(e+1)]=t}),console.log(i),this.$http.post("/uploadingSprite",i,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{a.target.value="",this.gameData[t][e].sprite.name=i.resourceName;let n="",l=(n="bgImage"===e?"gameBg":"stem")+"Sprite",o=window.stage.getChildByName("GAME"),r=o.getChildByName("GAME"+t).children[0].getChildByName(n+"Container").getChildByName(l),m=o.getChildByName("GAME"+t).children[0].getChildByName(n+"Container");if(console.log(m),r){let a=r.x,n=r.y;m.removeChild(r),window.res.hasOwnProperty(i.resourceName)||PIXI.loader.add(i.resourceName,i.path),PIXI.loader.load((o,d)=>{let g=d[i.resourceName].spritesheet,c=[];for(let t in g.textures)c.push(g.textures[t]);(r=new PIXI.extras.AnimatedSprite(c)).x=a,r.y=n,r.scale.set(this.gameData[t][e].sprite.scale),r.animationSpeed=1,r.play(),r.name=l,m.addChild(r),new s.a(r,(a,i)=>{this.gameData[t][e].sprite.x=a.toFixed(1),this.gameData[t][e].sprite.y=i.toFixed(1)}),this.gameData[t][e].sprite.show?r.visible=!0:r.visible=!1})}else this.gameData[t][e].sprite.x=0,this.gameData[t][e].sprite.y=0,window.res.hasOwnProperty(i.resourceName)||PIXI.loader.add(i.resourceName,i.path),PIXI.loader.load((a,n)=>{let o=n[i.resourceName].spritesheet,d=[];for(let t in o.textures)d.push(o.textures[t]);(r=new PIXI.extras.AnimatedSprite(d)).x=0,r.y=0,r.scale.set(this.gameData[t][e].sprite.scale),r.animationSpeed=1,r.play(),r.name=l,m.addChild(r),new s.a(r,(a,i)=>{this.gameData[t][e].sprite.x=a.toFixed(1),this.gameData[t][e].sprite.y=i.toFixed(1)}),this.gameData[t][e].sprite.show?r.visible=!0:r.visible=!1})})},uploadAudio(t,e){let a=e.target.files[0].name.split(".")[e.target.files[0].name.split(".").length-1];return-1===["mp3","wav"].indexOf(a)?(this.$message({message:"上传类型不符",type:"error"}),void(e.target.value="")):0===e.target.files.length?(this.$message({message:"上传文件个数不符合",type:"warning"}),void(e.target.value="")):void this.$http.post("/uploadingAudio",{audio:e.target.files[0]},{headers:{"Content-Type":"multipart/form-data"}}).then(a=>{this.gameData[t].subTitle.audio=a.resourceName,e.target.value="";let i=window.stage.getChildByName("GAME").getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].getChildByName("stemSound");this.gameData[t].subTitle.audioShow&&this.gameData[t].subTitle.soundImg.animate_name?i&&(i.visible=!0):i&&(i.visible=!1)})},verifyAnimationFiles(t){let e=[],a=Object.values(t).map((t,e)=>t.name).map(t=>(e.push(t.split(".")[1]),t.split(".")[0])),i=e.sort((t,e)=>t.length-e.length).toString(),s=["png","json","atlas"].toString(),n=a[0];return a.every((t,e)=>n===t)&&i===s},uploadAnimation(t,e,a){if(0===a.target.files.length||3!==a.target.files.length)return this.$message({message:"上传文件个数不符合",type:"warning"}),void(a.target.value="");if(!this.verifyAnimationFiles(a.target.files))return this.$message({message:"上传文件不符合",type:"warning"}),void(a.target.value="");let i={};Object.values(a.target.files).forEach((t,e)=>{i["animation"+(e+1)]=t}),this.$http.post("/uploadingAnimation",i,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{if(a.target.value="","soundImg"!==e){this.gameData[t][e].animate.name=i.resourceName;let a="",n=(a="bgImage"===e?"gameBg":"stem")+"Animate",l=window.stage.getChildByName("GAME"),o=l.getChildByName("GAME"+t).children[0].getChildByName(a+"Container").getChildByName(n),r=l.getChildByName("GAME"+t).children[0].getChildByName(a+"Container");if(o){let a=o.x,l=o.y;r.removeChild(o),window.res.hasOwnProperty(i.resourceName)||PIXI.loader.add(i.resourceName,i.path),PIXI.loader.load((m,d)=>{(o=new PIXI.spine.Spine(d[i.resourceName].spineData)).x=a,o.y=l,o.scale.set(this.gameData[t][e].animate.scale),o.name=n,o.state.setAnimation(1,"animation",!1),r.addChild(o),new s.a(o,(a,i)=>{this.gameData[t][e].animate.x=a.toFixed(1),this.gameData[t][e].animate.y=i.toFixed(1)}),this.gameData[t][e].animate.show?o.visible=!0:o.visible=!1})}else{this.gameData[t][e].animate.x=0,this.gameData[t][e].animate.y=0;(new Date).getTime();window.res.hasOwnProperty(i.resourceName)||PIXI.loader.add(i.resourceName,i.path),PIXI.loader.load((a,l)=>{(o=new PIXI.spine.Spine(l[i.resourceName].spineData)).x=0,o.y=0,o.scale.set(this.gameData[t][e].animate.scale),o.name=n,o.state.setAnimation(1,"animation",!1),r.addChild(o),new s.a(o,(a,i)=>{this.gameData[t][e].animate.x=a.toFixed(1),this.gameData[t][e].animate.y=i.toFixed(1)}),this.gameData[t][e].animate.show?o.visible=!0:o.visible=!1})}}else{this.gameData[t].subTitle[e].animate_name=i.resourceName,this.gameData[t].subTitle.soundImg.scale=1;let a="stemSound",n=window.stage.getChildByName("GAME"),l=n.getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0].getChildByName(a),o=n.getChildByName("GAME"+this.index).getChildByName("STEMTITLE").children[0];if(l){let e=l.x,n=l.y;o.removeChild(l),window.res.hasOwnProperty(i.resourceName)||PIXI.loader.add(i.resourceName,i.path),PIXI.loader.load((r,m)=>{(l=new PIXI.spine.Spine(m[i.resourceName].spineData)).name=a,l.state.setAnimation(1,"animation",!1),o.addChild(l),l.x=e,l.y=n,new s.a(l,(e,a)=>{this.gameData[t].subTitle.soundImg.x=e.toFixed(1),this.gameData[t].subTitle.soundImg.y=a.toFixed(1)}),this.gameData[t].subTitle.audioShow&&this.gameData[t].subTitle.audio?l.visible=!0:l.visible=!1})}else this.gameData[t].subTitle.soundImg.x=0,this.gameData[t].subTitle.soundImg.y=0,window.res.hasOwnProperty(i.resourceName)||PIXI.loader.add(i.resourceName,i.path),PIXI.loader.load((e,n)=>{(l=new PIXI.spine.Spine(n[i.resourceName].spineData)).x=0,l.y=0,l.name=a,l.state.setAnimation(1,"animation",!1),o.addChild(l),new s.a(l,(e,a)=>{this.gameData[t].subTitle.soundImg.x=e.toFixed(1),this.gameData[t].subTitle.soundImg.y=a.toFixed(1)}),this.gameData[t].subTitle.audioShow&&this.gameData[t].subTitle.audio?l.visible=!0:l.visible=!1})}a.target.value=""})},updateResourceData(){this.$emit("updateResourceData")},lockStatusData(t,e){if(t.image.show&&t.image.name){if(!t.image.width||!t.image.height)return void this.$message.error("绑定对象的宽高都不可为空");"true"===e.currentTarget.getAttribute("data-lock")?(e.currentTarget.setAttribute("data-lock","false"),t.image.ratio=0,t.image.lock=!1):(e.currentTarget.setAttribute("data-lock","true"),t.image.lock=!0,t.image.ratio=parseFloat(t.image.width)/parseFloat(t.image.height))}else this.$message({type:"warning",message:"舞台未绑定元素!"})}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"game-title"},[a("i",{ref:"bgImageTitle",class:t.tabShowStatus[t.index].child.bgImage?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow(t.index,"bgImage")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow(t.index,"bgImage")}}},[t._v("\n        背景图\n    ")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tabShowStatus[t.index].child.bgImage,expression:"tabShowStatus[index].child.bgImage"}],staticClass:"game-inner"},[a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource(t.index,"bgImage","image")}},model:{value:t.item.bgImage.image.show,callback:function(e){t.$set(t.item.bgImage.image,"show",e)},expression:"item.bgImage.image.show"}},[t._v("图片\n            ")])],1),t._v(" "),a("div",{staticClass:"upload"},[a("div",{staticClass:"img-box"},[a("img",{attrs:{src:t.resourceData[t.item.bgImage.image.name],alt:"",width:"131",height:"96"}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改图片")]),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){return t.uploadImage(t.index,"bgImage",e)}}})])])]),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource(t.index,"bgImage","sprite")}},model:{value:t.item.bgImage.sprite.show,callback:function(e){t.$set(t.item.bgImage.sprite,"show",e)},expression:"item.bgImage.sprite.show"}},[t._v("精灵序列\n            ")])],1),t._v(" "),a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("\n                精灵文件：\n            ")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.item.bgImage.sprite.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadSprite(t.index,"bgImage",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"bgImage","sprite","x")}},model:{value:t.item.bgImage.sprite.x,callback:function(e){t.$set(t.item.bgImage.sprite,"x",e)},expression:"item.bgImage.sprite.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"bgImage","sprite","y")}},model:{value:t.item.bgImage.sprite.y,callback:function(e){t.$set(t.item.bgImage.sprite,"y",e)},expression:"item.bgImage.sprite.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"bgImage","sprite","scale")}},model:{value:t.item.bgImage.sprite.scale,callback:function(e){t.$set(t.item.bgImage.sprite,"scale",e)},expression:"item.bgImage.sprite.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.item.bgImage.sprite.loop,callback:function(e){t.$set(t.item.bgImage.sprite,"loop",e)},expression:"item.bgImage.sprite.loop"}})],1),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource(t.index,"bgImage","animate")}},model:{value:t.item.bgImage.animate.show,callback:function(e){t.$set(t.item.bgImage.animate,"show",e)},expression:"item.bgImage.animate.show"}},[t._v("动画\n            ")])],1),t._v(" "),a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("动画文件：")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.item.bgImage.animate.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadAnimation(t.index,"bgImage",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"bgImage","animate","x")}},model:{value:t.item.bgImage.animate.x,callback:function(e){t.$set(t.item.bgImage.animate,"x",e)},expression:"item.bgImage.animate.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"bgImage","animate","y")}},model:{value:t.item.bgImage.animate.y,callback:function(e){t.$set(t.item.bgImage.animate,"y",e)},expression:"item.bgImage.animate.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"bgImage","animate","scale")}},model:{value:t.item.bgImage.animate.scale,callback:function(e){t.$set(t.item.bgImage.animate,"scale",e)},expression:"item.bgImage.animate.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.item.bgImage.animate.loop,callback:function(e){t.$set(t.item.bgImage.animate,"loop",e)},expression:"item.bgImage.animate.loop"}})],1)],1),t._v(" "),a("div",{staticClass:"game-title"},[a("i",{ref:"stemImgTitle",class:t.tabShowStatus[t.index].child.stemImg?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow(t.index,"stemImg")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow(t.index,"stemImg")}}},[t._v("\n            题干\n        ")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tabShowStatus[t.index].child.stemImg,expression:"tabShowStatus[index].child.stemImg"}],staticClass:"game-inner"},[a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource(t.index,"stemImg","image")}},model:{value:t.item.stemImg.image.show,callback:function(e){t.$set(t.item.stemImg.image,"show",e)},expression:"item.stemImg.image.show"}},[t._v("图片\n            ")])],1),t._v(" "),a("div",[a("div",{staticClass:"upload"},[a("div",{staticClass:"img-box"},[a("img",{attrs:{src:t.resourceData[t.item.stemImg.image.name],alt:"",width:"131",height:"96"}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改图片")]),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){return t.uploadImage(t.index,"stemImg",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","image","x")}},model:{value:t.item.stemImg.image.x,callback:function(e){t.$set(t.item.stemImg.image,"x",e)},expression:"item.stemImg.image.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","image","y")}},model:{value:t.item.stemImg.image.y,callback:function(e){t.$set(t.item.stemImg.image,"y",e)},expression:"item.stemImg.image.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("div",{staticClass:"lockStatus"},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","image","width",t.item.stemImg.image.ratio)}},model:{value:t.item.stemImg.image.width,callback:function(e){t.$set(t.item.stemImg.image,"width",e)},expression:"item.stemImg.image.width"}},[a("template",{slot:"prepend"},[t._v("W：")])],2),t._v(" "),a("span",{staticClass:"lock_block",attrs:{lockRatio:t.item.stemImg.image.ratio}},[a("img",{attrs:{src:t.item.stemImg.image.lock?t.lockImg:t.unLockImg,"data-lock":"false",alt:""},on:{click:function(e){return t.lockStatusData(t.item.stemImg,e)}}})]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","image","height",t.item.stemImg.image.ratio)}},model:{value:t.item.stemImg.image.height,callback:function(e){t.$set(t.item.stemImg.image,"height",e)},expression:"item.stemImg.image.height"}},[a("template",{slot:"prepend"},[t._v("H：")])],2)],1)],1),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource(t.index,"stemImg","sprite")}},model:{value:t.item.stemImg.sprite.show,callback:function(e){t.$set(t.item.stemImg.sprite,"show",e)},expression:"item.stemImg.sprite.show"}},[t._v("精灵序列\n            ")])],1),t._v(" "),a("div",[a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("\n                精灵文件：\n            ")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.item.stemImg.sprite.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadSprite(t.index,"stemImg",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","sprite","x")}},model:{value:t.item.stemImg.sprite.x,callback:function(e){t.$set(t.item.stemImg.sprite,"x",e)},expression:"item.stemImg.sprite.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","sprite","y")}},model:{value:t.item.stemImg.sprite.y,callback:function(e){t.$set(t.item.stemImg.sprite,"y",e)},expression:"item.stemImg.sprite.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","sprite","scale")}},model:{value:t.item.stemImg.sprite.scale,callback:function(e){t.$set(t.item.stemImg.sprite,"scale",e)},expression:"item.stemImg.sprite.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.item.stemImg.sprite.loop,callback:function(e){t.$set(t.item.stemImg.sprite,"loop",e)},expression:"item.stemImg.sprite.loop"}})],1)],1),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource(t.index,"stemImg","animate")}},model:{value:t.item.stemImg.animate.show,callback:function(e){t.$set(t.item.stemImg.animate,"show",e)},expression:"item.stemImg.animate.show"}},[t._v("动画\n            ")])],1),t._v(" "),a("div",[a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("动画文件：")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.item.stemImg.animate.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadAnimation(t.index,"stemImg",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","animate","x")}},model:{value:t.item.stemImg.animate.x,callback:function(e){t.$set(t.item.stemImg.animate,"x",e)},expression:"item.stemImg.animate.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","animate","y")}},model:{value:t.item.stemImg.animate.y,callback:function(e){t.$set(t.item.stemImg.animate,"y",e)},expression:"item.stemImg.animate.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setElementStatus(t.index,"stemImg","animate","scale")}},model:{value:t.item.stemImg.animate.scale,callback:function(e){t.$set(t.item.stemImg.animate,"scale",e)},expression:"item.stemImg.animate.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.item.stemImg.animate.loop,callback:function(e){t.$set(t.item.stemImg.animate,"loop",e)},expression:"item.stemImg.animate.loop"}})],1)],1),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource(t.index,"subTitle","audio")}},model:{value:t.item.subTitle.audioShow,callback:function(e){t.$set(t.item.subTitle,"audioShow",e)},expression:"item.subTitle.audioShow"}},[t._v("音频\n            ")])],1),t._v(" "),a("div",[a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("音频文件：")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.item.subTitle.audio)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){return t.uploadAudio(t.index,e)}}})])])]),t._v(" "),a("div",{staticClass:"edit-range-audio"},[a("span",[t._v("音量：")]),t._v(" "),a("el-slider",{attrs:{min:Number(0),max:Number(1),step:Number(.1)},model:{value:t.item.subTitle.audio_volume,callback:function(e){t.$set(t.item.subTitle,"audio_volume",e)},expression:"item.subTitle.audio_volume"}})],1),t._v(" "),a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("图标动画")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.item.subTitle.soundImg.animate_name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadAnimation(t.index,"soundImg",e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setSubTitileAttr("soundImg","x")}},model:{value:t.item.subTitle.soundImg.x,callback:function(e){t.$set(t.item.subTitle.soundImg,"x",e)},expression:"item.subTitle.soundImg.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setSubTitileAttr("soundImg","y")}},model:{value:t.item.subTitle.soundImg.y,callback:function(e){t.$set(t.item.subTitle.soundImg,"y",e)},expression:"item.subTitle.soundImg.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2)],1),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setStemTextStatus(t.item.subTitle.stem.show)}},model:{value:t.item.subTitle.stem.show,callback:function(e){t.$set(t.item.subTitle.stem,"show",e)},expression:"item.subTitle.stem.show"}},[t._v("题干文字")])],1),t._v(" "),a("div",[a("div",{staticClass:"edit-textarea"},[a("span",[t._v("内容：")]),t._v(" "),a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.item.subTitle.stem.text,expression:"item.subTitle.stem.text"}],attrs:{name:"",id:"",cols:"30",rows:"10",placeholder:"请输入文字"},domProps:{value:t.item.subTitle.stem.text},on:{input:[function(e){e.target.composing||t.$set(t.item.subTitle.stem,"text",e.target.value)},function(e){return t.setStemText("text")}]}})]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setStemText("width")}},model:{value:t.item.subTitle.stem.width,callback:function(e){t.$set(t.item.subTitle.stem,"width",e)},expression:"item.subTitle.stem.width"}},[a("template",{slot:"prepend"},[t._v("段落宽度：")])],2),t._v(" "),a("div",{staticClass:"edit-select"},[a("span",[t._v("字体：")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:function(e){return t.setStemText("fontFamily")}},model:{value:t.item.subTitle.stem.fontFamily,callback:function(e){t.$set(t.item.subTitle.stem,"fontFamily",e)},expression:"item.subTitle.stem.fontFamily"}},t._l(t.fontFamily,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"3",size:"mini"},nativeOn:{input:function(e){return t.setStemText("fontSize")}},model:{value:t.item.subTitle.stem.fontSize,callback:function(e){t.$set(t.item.subTitle.stem,"fontSize",e)},expression:"item.subTitle.stem.fontSize"}},[a("template",{slot:"prepend"},[t._v("字号：")])],2),t._v(" "),a("div",{staticClass:"edit-select"},[a("span",[t._v("对齐：")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择",size:"mini"},on:{change:function(e){return t.setStemText("textAlign")}},model:{value:t.item.subTitle.stem.textAlign,callback:function(e){t.$set(t.item.subTitle.stem,"textAlign",e)},expression:"item.subTitle.stem.textAlign"}},t._l(t.textAlign,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"3",size:"mini"},nativeOn:{input:function(e){return t.setStemText("letterSpacing")}},model:{value:t.item.subTitle.stem.letterSpacing,callback:function(e){t.$set(t.item.subTitle.stem,"letterSpacing",e)},expression:"item.subTitle.stem.letterSpacing"}},[a("template",{slot:"prepend"},[t._v("字间距：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",maxlength:"3",size:"mini"},nativeOn:{input:function(e){return t.setStemText("lineHeight")}},model:{value:t.item.subTitle.stem.lineHeight,callback:function(e){t.$set(t.item.subTitle.stem,"lineHeight",e)},expression:"item.subTitle.stem.lineHeight"}},[a("template",{slot:"prepend"},[t._v("行间距：")])],2),t._v(" "),a("div",{staticClass:"edit-select"},[a("span",[t._v("颜色：")]),t._v(" "),a("el-color-picker",{on:{change:function(e){return t.setStemText("color")}},model:{value:t.item.subTitle.stem.color,callback:function(e){t.$set(t.item.subTitle.stem,"color",e)},expression:"item.subTitle.stem.color"}})],1),t._v(" "),a("div",{staticClass:"font-style"},[a("span",{class:t.item.subTitle.stem.strong?"font-style-color":"",on:{click:function(e){return t.setGoldTextFontStyle("strong",t.index)}}},[t._v("B\n            ")]),t._v(" "),a("span",{class:t.item.subTitle.stem.italic?"font-style-color":"",on:{click:function(e){return t.setGoldTextFontStyle("italic",t.index)}}},[t._v("I\n            ")])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setSubTitileAttr("stem","x")}},model:{value:t.item.subTitle.stem.x,callback:function(e){t.$set(t.item.subTitle.stem,"x",e)},expression:"item.subTitle.stem.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},nativeOn:{input:function(e){return t.setSubTitileAttr("stem","y")}},model:{value:t.item.subTitle.stem.y,callback:function(e){t.$set(t.item.subTitle.stem,"y",e)},expression:"item.subTitle.stem.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2)],1)])])},staticRenderFns:[]};var g=a("C7Lr")(m,d,!1,function(t){a("ZMII")},"data-v-2d7c1fd2",null).exports,c=a("HQUh"),u={name:"EditGamePrivate",data(){return{contentType:[{label:"word",name:"单词"},{label:"sentence",name:"句子"}],fontFamily:[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:"SimSun"},{label:"黑体",value:"SimHei"},{label:"方正粗圆",value:"FZCuYuan-M03S"},{label:"方正粗圆简",value:"FZZhunYuan-M02S"}],textAlign:[{label:"左对齐",value:"left"},{label:"右对齐",value:"right"},{label:"居中对齐",value:"center"},{label:"两端对齐",value:"justify"}],lockImg:this.resourceData.image_lock_off,checkbox:!1,radio:1,switchStatus:!1,audio_name:"",image:{show:!0,x:0,y:0,lock:!1,width:0,height:0,name:"",ratio:0},sprite:{show:!1,x:"500",y:"0",name:"",scale:"1",loop:!1},animate:{show:!1,x:"100",y:"100",name:"",scale:"3",loop:!0}}},props:["allData","gameData","resourceData","item","index","tabShowStatus"],mounted(){},methods:{setSubTitileAttr(t,e){let a="";a="soundImg"===t?"stemSound":"rightKey";let i=window.stage.getChildByName("GAME").getChildByName("GAME"+this.index).getChildByName(a),s=this.item.rightKey;if(i){if("x"===e&&s[e]>1920)return this.$message.error("输入数值超出范围 应为0-1920"),void(s[e]=i[e]);if("y"===e&s[e]>1080)return this.$message.error("输入数值超出范围 应为0-1080"),void(s[e]=i[e]);if(this.isFloat(parseFloat(s[e])))s[e]=parseFloat(s[e].split(".")[0]+"."+s[e].split(".")[1].substr(0,1));else{s[e];s[e]&&/^\d*\.+$/g.test(s[e])?s[e]=parseFloat(s[e])+".":s[e]=s[e]?parseFloat(s[e]):0}parseFloat(s[e])<0&&(s[e]=i[e]),i[e]=s[e]}},setStemText(t){let e=this.item.rightKey,a=window.stage.getChildByName("GAME"),i=a.getChildByName("GAME"+this.index).getChildByName("rightKey");"strong"!==t&&"italic"!==t||(e[t]=!e[t]);let s=/^\d{1,3}$/;if("letterSpacing"!==t&&"lineHeight"!==t||(s=/^0?-\d?\.?\d?$/),"width"===t&&(e[t]>1920||e[t]<0))return e.width=i._style.wordWrapWidth,void this.$message.error("输入数值超出范围 应为0-1920");if("fontSize"==t)if(0==e[t]){if(i)return void(i.visible=!1)}else i&&(i.visible=!0);if("fontSize"==t){if(!s.test(e[t]))return void this.$message({type:"error",message:"输入错误"});e[t]>120&&(e[t]=120,this.$message({type:"warning",message:"超过最大字体120"}))}"lineHeight"!=t&&"letterSpacing"!=t||(s.test(e[t])?e[t]=parseFloat(e[t])?parseFloat(e[t]).toFixed(0):"-":e[t]=parseFloat(e[t])?parseFloat(e[t]).toFixed(0):0),"width"==t&&(e[t]=this.verifyNumber(e[t])),e.color=e.color?e.color:"#000";let n=new PIXI.TextStyle({fontFamily:e.fontFamily,fontSize:parseInt(e.fontSize),wordWrap:!0,wordWrapWidth:parseInt(e.width),breakWords:!0,lineHeight:parseInt(e.lineHeight),letterSpacing:parseInt(e.letterSpacing),align:e.textAlign,fill:e.color,width:e.width,fontWeight:e.strong?"bold":"",fontStyle:e.italic?"italic":""});if(i){if("text"===t)return void i.setText(e.text);i.setStyle(n),e.show?i.visible=!0:i.visible=!1}else{let t=new Text(e.text,n);t.name="rightKey",console.log(t),a.getChildByName("GAME"+this.index).addChild(t),e.show?t.visible=!0:t.visible=!1}},setImageLock(t){if(t){if(t.lock=!t.lock,!t.height||!t.width)return void this.$message({message:"X或Y为0或为空 无法计算比例",type:"warning"});t.lock&&(t.ratio=t.width/t.height)}else{if(this.image.lock=!this.image.lock,!this.image.height||!this.image.width)return void this.$message({message:"X或Y为0或为空 无法计算比例",type:"warning"});this.image.lock&&(this.image.ratio=this.image.width/this.image.height)}},setAttr(t,e,a,i,s){i=parseFloat(i);let n=stage.getChildByName("GAME").getChildByName("GAME"+this.index).getChildByName("componentContainer");if(n&&n.getChildByName(e)){if("left"===a&&i>1920)return void this.$message.error("输入数值超出范围 应为0-1920");if("top"===a&&i>1080)return void this.$message.error("输入数值超出范围 应为0-1080");switch("width"===a&&s.lock&&(s.height=(i/s.ratio).toFixed(0),n.getChildByName(e).height=i/s.ratio),"height"===a&&s.lock&&(s.width=(i*s.ratio).toFixed(0),n.getChildByName(e).width=i*s.ratio),a){case"left":n.getChildByName(e).x=""==i?0:parseFloat(i);break;case"top":n.getChildByName(e).y=""==i?0:parseFloat(i);break;case"width":n.getChildByName(e).width=""==i?0:parseFloat(i);break;case"height":n.getChildByName(e).height=""==i?0:parseFloat(i);break;case"scale":let t=""==i?0:parseFloat(i);n.getChildByName(e).scale.set(t)}}},changeOptionArr(t,e){switch(t){case"add":let a={id:"",show:!0,x:0,y:0,lock:!1,width:0,height:0,name:"",ratio:1,rightKey:"",componentName:"optionImage"+this.item.optionsData.length};this.item.optionsData.push(a);break;case"copy":let i=JSON.parse(JSON.stringify(this.item.optionsData[e]));this.item.optionsData.push(i);break;case"del":if(this.item.optionsData.length<=1)return this.$message({message:"请至少保留一个选项",type:"warning"}),!1;this.item.optionsData.splice(e,1)}if(this.item.optionsData.forEach((t,e)=>{t.id=e,t.componentName="optionImage"+e}),Object(c.RenderElementByIndex)(this.index,this.allData),"copy"==t){console.log(stage,"stage");let t=-1==store.state.pageNumber?0:store.state.pageNumber,e=stage.getChildByName("GAME").getChildByName("GAME"+t).getChildByName("componentContainer").getChildByName("optionImage"+(this.item.optionsData.length-1));stage.getChildByName("GAME").getChildByName("GAME"+t).getChildByName("componentContainer").setChildIndex(e,stage.getChildByName("GAME").getChildByName("GAME"+t).getChildByName("componentContainer").children.length-1)}},tabShow(t,e){console.log(t,e),console.log(this.tabShowStatus),console.log(this.$refs);let a=this.$refs[e+"Title"];this.tabShowStatus[t].child[e]?(this.tabShowStatus[t].child[e]=!1,a.className="el-icon-arrow-right"):(Object.keys(this.tabShowStatus[t].child).forEach((e,a)=>{this.tabShowStatus[t].child[e]=!1}),this.tabShowStatus[t].child[e]=!0,a.className="el-icon-arrow-down")},isFloat:t=>/^-?\d*\.\d+$/.test(t),verifyAnimationFiles(t){let e=[],a=Object.values(t).map((t,e)=>t.name).map(t=>(e.push(t.split(".")[1]),t.split(".")[0])),i=e.sort((t,e)=>t.length-e.length).toString(),s=["png","json","atlas"].toString(),n=a[0];return a.every((t,e)=>n===t)&&i===s},verifySpriteFiles(t){let e=[],a=Object.values(t).map((t,e)=>t.name).map(t=>(e.push(t.split(".")[1]),t.split(".")[0])),i=e.sort((t,e)=>t.length-e.length).toString(),s=["png","json"].toString(),n=a[0];return a.every((t,e)=>n===t)&&i===s},uploadImage(t,e,a){let i=this,s=e.target.files[0].name.split(".")[e.target.files[0].name.split(".").length-1];-1!==["jpg","png"].indexOf(s)?0!==e.target.files.length?this.$http.post("/uploadingImage",{image:e.target.files[0]},{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{a.name=t.resourceName,a.width=t.width,a.height=t.height,this.updateResourceData(),Object(c.UploadAndRenderEle)(i.index,a.componentName,t,i.allData),e.target.value=""}):this.$message({message:"上传文件个数不符合",type:"warning"}):this.$message({message:"上传类型不符",type:"error"})},uploadAnimation(t,e,a,i=!1){if(0===e.target.files.length||3!==e.target.files.length)return void this.$message({message:"上传文件个数不符合",type:"warning"});if(!this.verifyAnimationFiles(e.target.files))return void this.$message({message:"上传文件不符合",type:"warning"});let s={};Object.values(e.target.files).forEach((t,e)=>{s["animation"+(e+1)]=t}),this.$http.post("/uploadingAnimation",s,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{i?(a.name=t.resourceName,e.target.value=""):(this.animate.name=t.resourceName,e.target.value="")})},uploadSprite(t,e){if(0===e.target.files.length||2!==e.target.files.length)return void this.$message({message:"上传文件个数不符合",type:"warning"});if(!this.verifySpriteFiles(e.target.files))return void this.$message({message:"上传文件不符合",type:"warning"});let a={};Object.values(e.target.files).forEach((t,e)=>{a["sprite"+(e+1)]=t}),console.log(a),this.$http.post("/uploadingSprite",a,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{this.sprite.name=t.resourceName,e.target.value=""})},uploadAudio(t,e){let a=e.target.files[0].name.split(".")[e.target.files[0].name.split(".").length-1];-1!==["mp3","wav"].indexOf(a)?0!==e.target.files.length?this.$http.post("/uploadingAudio",{audio:e.target.files[0]},{headers:{"Content-Type":"multipart/form-data"}}).then(t=>{this.audio_name=t.resourceName,e.target.value=""}):this.$message({message:"上传文件个数不符合",type:"warning"}):this.$message({message:"上传类型不符",type:"error"})},updateResourceData(){this.$emit("updateResourceData")}}},h={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"game-title"},[a("i",{ref:"option1Title",class:t.tabShowStatus[t.index].child.option1?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow(t.index,"option1")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow(t.index,"option1")}}},[t._v("\n        题目\n        ")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tabShowStatus[t.index].child.option1,expression:"tabShowStatus[index].child.option1"}],staticClass:"game-inner"},[a("div",{staticClass:"option-animate",staticStyle:{"border-bottom":"none","padding-bottom":"0"}},[a("div",[a("el-input",{staticStyle:{width:"80%!important"},attrs:{placeholder:"请输入元素名称",size:"mini"},model:{value:t.item.rightKey.text,callback:function(e){t.$set(t.item.rightKey,"text",e)},expression:"item.rightKey.text"}},[a("template",{slot:"prepend"},[t._v("正确答案：")])],2),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("div",{staticClass:"option-animate-title"},[t._v("\n                    答案类型\n                ")]),t._v(" "),a("div",{staticClass:"option-animate-radio"},t._l(t.contentType,function(e,i){return a("el-radio",{key:i,attrs:{label:e.label},model:{value:t.item.rightKey.contentType,callback:function(e){t.$set(t.item.rightKey,"contentType",e)},expression:"item.rightKey.contentType"}},[t._v(t._s(e.name))])}),1),t._v(" "),a("div",{staticClass:"upload"},[a("div",{staticClass:"img-box"},[a("img",{attrs:{src:t.resourceData[t.item.optionsData.image.name],alt:"",width:"131",height:"96"}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改图片")]),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){return t.uploadImage("image",e,t.item.optionsData.image,"")}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{input:function(e){return t.setAttr(0,"optionImage0","left",e)}},model:{value:t.item.optionsData.image.x,callback:function(e){t.$set(t.item.optionsData.image,"x",e)},expression:"item.optionsData.image.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},on:{input:function(e){return t.setAttr(0,"optionImage0","top",e)}},model:{value:t.item.optionsData.image.y,callback:function(e){t.$set(t.item.optionsData.image,"y",e)},expression:"item.optionsData.image.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入内容",size:"mini"},on:{input:function(e){return t.setAttr(0,"optionImage0","width",e,t.item.optionsData.image)}},model:{value:t.item.optionsData.image.width,callback:function(e){t.$set(t.item.optionsData.image,"width",e)},expression:"item.optionsData.image.width"}},[a("template",{slot:"prepend"},[t._v("W：")])],2),t._v(" "),a("div",{staticStyle:{float:"left","text-align":"center",width:"20%",height:"28px","margin-top":"15px","line-height":"32px"}},[t.item.optionsData.image.lock?a("img",{staticStyle:{height:"14px",cursor:"pointer"},attrs:{src:t.resourceData.image_lock_on,alt:""},on:{click:function(e){return t.setImageLock(t.item.optionsData.image)}}}):t._e(),t._v(" "),t.item.optionsData.image.lock?t._e():a("img",{staticStyle:{height:"14px",cursor:"pointer"},attrs:{src:t.resourceData.image_lock_off,alt:""},on:{click:function(e){return t.setImageLock(t.item.optionsData.image)}}})]),t._v(" "),a("el-input",{staticStyle:{width:"40%"},attrs:{placeholder:"请输入内容",size:"mini"},on:{input:function(e){return t.setAttr(0,"optionImage0","height",e,t.item.optionsData.image)}},model:{value:t.item.optionsData.image.height,callback:function(e){t.$set(t.item.optionsData.image,"height",e)},expression:"item.optionsData.image.height"}},[a("template",{slot:"prepend"},[t._v("H：")])],2)],1)])])])},staticRenderFns:[]};var p=a("C7Lr")(u,h,!1,function(t){a("B2fp")},"data-v-7598759d",null).exports,v={name:"EditGameBefore",props:["allData","resourceData"],data:()=>({}),methods:{updateResourceData(){this.$emit("updateResourceData")}},mounted(){}},w={render:function(){var t=this.$createElement;return(this._self._c||t)("div")},staticRenderFns:[]};var f=a("C7Lr")(v,w,!1,function(t){a("MClN")},"data-v-9733a958",null).exports,b={name:"EditGameAfter",props:["allData","resourceData"],data:()=>({}),methods:{updateResourceData(){this.$emit("updateResourceData")}},mounted(){}},y={render:function(){var t=this.$createElement;return(this._self._c||t)("div")},staticRenderFns:[]};var x=a("C7Lr")(b,y,!1,function(t){a("G137")},"data-v-19b603a8",null).exports,S={name:"EditGame",data:()=>({gameData:null,showStatus:!1,publicSourceData:null,tabShowStatus:[],publicChildStatus:{button:!1,animate:!1,audio:!1},publicStatus:!1,resourceData:null,feedbackAnimateData:null,tabShowLists:{bgImage:!1,stemImg:!1,subTitle:!1,option:!1,option1:!1,option2:!1,option3:!1,option4:!1,option5:!1,option6:!1,option7:!1,option8:!1,option9:!1,option10:!1}}),props:["allData"],methods:{setLock(t){},getJSON(){this.getResourceData(()=>{this.showStatus=!0}),this.gameData=this.allData.sources,this.feedbackAnimateData=this.allData.feedbackAnimate,this.publicSourceData=this.allData.publicSourceData,this.tabShowStatus=[],this.gameData.forEach((t,e)=>{this.tabShowStatus.push({show:!1,lock:!1,child:JSON.parse(JSON.stringify(this.tabShowLists))})})},getResourceData(t){this.$http.get("/getResourceJSON",{params:{}}).then(e=>{this.resourceData=e,t&&t()})},changeArr(t,e){if("add"===t){let t=["x","y","width","height"];let e=JSON.parse(JSON.stringify(this.gameData[0]));!function e(a){Object.values(a).forEach((i,s)=>{"[object Object]"===Object.prototype.toString.call(i)?"stem"===Object.keys(a)[s]?(i.show=!1,i.text="请输入文本",i.width=960,i.x=0,i.y=0,i.lineHeight=60,i.letterSpacing=30,i.fontFamily="Microsoft YaHei",i.fontSize=36,i.color="#000000",i.textAlign="justify",i.strong=!1,i.italic=!1,i.padding=40,i.componentName="stemText"):e(i):"[object Array]"===Object.prototype.toString.call(i)?(a[Object.keys(a)[s]]=a[Object.keys(a)[s]].splice(0,1),e(a[Object.keys(a)[s]])):"[object String]"===Object.prototype.toString.call(i)?"componentName"!=Object.keys(a)[s]&&(t.indexOf(Object.keys(a)[s])>-1?a[Object.keys(a)[s]]=0:"scale"===Object.keys(a)[s]?a[Object.keys(a)[s]]=1:"ratio"===Object.keys(a)[s]?a[Object.keys(a)[s]]=1:a[Object.keys(a)[s]]=""):"[object Number]"===Object.prototype.toString.call(i)&&(t.indexOf(Object.keys(a)[s])>-1?a[Object.keys(a)[s]]=0:"scale"===Object.keys(a)[s]?a[Object.keys(a)[s]]=1:"ratio"===Object.keys(a)[s]?a[Object.keys(a)[s]]=1:a[Object.keys(a)[s]]=0)})}(e),this.gameData.push(e),this.tabShowStatus.push({show:!1,lock:!1,child:JSON.parse(JSON.stringify(this.tabShowLists))}),Object(c.CopyPageAndRender)(this.gameData.length-1,e,this.allData)}else if("copy"===t){let t=JSON.parse(JSON.stringify(this.gameData[e]));this.gameData.push(JSON.parse(JSON.stringify(this.gameData[e]))),this.tabShowStatus.push({show:!1,lock:!1,child:JSON.parse(JSON.stringify(this.tabShowLists))}),Object(c.CopyPageAndRender)(this.gameData.length-1,t,this.allData)}else"del"===t&&this.gameData.length>1&&this.$confirm("此操作将删除选项, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message({type:"success",message:"删除成功!"}),this.gameData.splice(e,1),this.tabShowStatus.splice(e,1),store.dispatch("setPageNumber",0),window.stage.getChildByName("GAME").removeChildren(),Object(c.RenderAllData)(!0,this.allData)}).catch(()=>{this.$message({type:"info",message:"已取消"})})},tabShow(t,e){let a=this.$refs[e+"Title"],i=this.tabShowStatus[t].show;if(Object.keys(this.tabShowStatus[t].child).forEach((e,a)=>{this.tabShowStatus[t].child[e]=!1}),i)this.tabShowStatus[t].show=!1,a.className="el-icon-arrow-right",store.dispatch("setPageNumber",-1);else{let e=window.stage.getChildByName("GAME");this.tabShowStatus.forEach((t,e)=>{this.tabShowStatus[e].show=!1}),e.children.forEach((t,e)=>{t.visible=!1}),this.tabShowStatus[t].show=!0,e.getChildByName("GAME"+t).visible=!0,a.className="el-icon-arrow-down",store.dispatch("setPageNumber",t)}console.log(store.state.pageNumber)},updateResourceData(){this.getResourceData()}},mounted(){this.getJSON()},components:{EditGamePublic:g,EditGamePrivate:p,EditGameBefore:f,EditGameAfter:x}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.showStatus?a("div",{staticClass:"game"},[a("EditGameBefore",{attrs:{gameData:t.gameData,resourceData:t.resourceData,allData:t.allData},on:{updateResourceData:t.updateResourceData}}),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),t._l(t.gameData,function(e,i){return a("div",{staticClass:"game-box",style:{marginTop:0===i?"8px":0}},[a("div",{staticClass:"game-title",staticStyle:{background:"#313131","padding-left":"8px","border-bottom":"1px solid #232323"},style:{background:t.tabShowStatus[i].show?"#409EFF":"#313131"},on:{click:function(e){return t.setLock(i)}}},[a("i",{ref:"oneTitle",refInFor:!0,class:t.tabShowStatus[i].show?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow(i,"one")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow(i,"one")}}},[t._v("\n                内容页"+t._s(i+1)+"\n            ")]),t._v(" "),a("i",{staticClass:"game-title-icon el-icon-delete",on:{click:function(e){return t.changeArr("del",i)}}}),t._v(" "),a("i",{staticClass:"game-title-icon el-icon-tickets",on:{click:function(e){return t.changeArr("copy",i)}}}),t._v(" "),a("i",{staticClass:"game-title-icon el-icon-plus",on:{click:function(e){return t.changeArr("add",i)}}})]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.tabShowStatus[i].show,expression:"tabShowStatus[index].show"}]},[a("EditGamePublic",{attrs:{gameData:t.gameData,item:e,index:i,resourceData:t.resourceData,allData:t.allData,tabShowStatus:t.tabShowStatus},on:{updateResourceData:t.updateResourceData}}),t._v(" "),a("EditGamePrivate",{attrs:{gameData:t.gameData,item:e,index:i,resourceData:t.resourceData,allData:t.allData,tabShowStatus:t.tabShowStatus,tabShowLists:t.tabShowLists},on:{updateResourceData:t.updateResourceData}})],1)])}),t._v(" "),a("div",{staticStyle:{clear:"both"}}),t._v(" "),a("EditGameAfter",{attrs:{gameData:t.gameData,resourceData:t.resourceData,allData:t.allData},on:{updateResourceData:t.updateResourceData}})],2):t._e()},staticRenderFns:[]};var D=a("C7Lr")(S,_,!1,function(t){a("VsuD")},null,null).exports;var C={name:"EditEnd",data:()=>({time:0,label:"1",endData:null,showStatus:!1,tabShowStatus:{endBg:!1,goldNum:!1},fontFamily:[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:"SimSun"},{label:"黑体",value:"SimHei"},{label:"方正粗圆",value:"FZCuYuan-M03S"},{label:"方正粗圆简",value:"FZZhunYuan-M02S"}],resourceData:null}),props:["allData"],methods:{setGoldTextFontStyle(t){this.endData.goldText[t]=!this.endData.goldText[t],this.endData.goldText[t]?this.endData.goldText.fontWeight="bold":this.endData.goldText.fontWeight="normal","italic"==t&&(this.endData.goldText[t]?this.endData.goldText.fontStyle="italic":this.endData.goldText.fontStyle="")},setResource(t,e){this.endData[t][e].show||(this.endData[t][e].name="")},tabShow(t,e){this.$refs[e];this.tabShowStatus[t]?this.tabShowStatus[t]=!1:(Object.keys(this.tabShowStatus).forEach((t,e)=>{this.tabShowStatus[t]=!1}),this.tabShowStatus[t]=!0)},getJSON(){this.endData=this.allData.one.end,this.getResourceData(()=>{this.showStatus=!0})},getResourceData(t){this.$http.get("/getResourceJSON",{params:{}}).then(e=>{this.resourceData=e,t&&t()})},uploadAnimation(t){if(0===t.target.files.length||3!==t.target.files.length)return void this.$message({message:"上传文件个数不符合",type:"warning"});let e={};Object.values(t.target.files).forEach((t,a)=>{e["animation"+(a+1)]=t}),this.$http.post("/uploadingAnimation",e,{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{t.target.value="",this.endData.endBg.animate.name=e.resourceName})},uploadImage(t){let e=t.target.files[0].name.split(".")[t.target.files[0].name.split(".").length-1];-1!==["jpg","png"].indexOf(e)?0!==t.target.files.length?t.target.files[0].size/1024/1024>1?this.$message({message:"上传文件大小在1M以内",type:"warning"}):this.$http.post("/uploadingImage",{image:t.target.files[0]},{headers:{"Content-Type":"multipart/form-data"}}).then(e=>{console.log(e),t.target.value="",this.endData.endBg.image.name=e.resourceName,this.endData.endBg.image.width=e.width,this.endData.endBg.image.height=e.height,this.endData.endBg.image.x=0,this.endData.endBg.image.y=0,this.getResourceData()}):this.$message({message:"上传文件个数不符合",type:"warning"}):this.$message({message:"上传类型不符",type:"error"})}},mounted(){this.getJSON()}},B={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.showStatus?a("div",{staticClass:"end"},[a("div",{staticClass:"end-time"},[a("el-input",{staticStyle:{width:"100%","margin-top":"0"},attrs:{placeholder:"",size:"mini"},model:{value:t.endData.jumpResultTime,callback:function(e){t.$set(t.endData,"jumpResultTime",e)},expression:"endData.jumpResultTime"}},[a("template",{slot:"prepend"},[t._v("最后一题停留时间")]),t._v(" "),a("template",{slot:"append"},[t._v("ms")])],2)],1),t._v(" "),a("div",{staticClass:"end-title"},[a("i",{ref:"endBgTitle",class:t.tabShowStatus.endBg?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow("endBg","endBgTitle")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow("endBg","endBgTitle")}}},[t._v("\n            背景图\n        ")])]),t._v(" "),t.tabShowStatus.endBg?a("div",{staticClass:"end-inner"},[a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource("endBg","image")}},model:{value:t.endData.endBg.image.show,callback:function(e){t.$set(t.endData.endBg.image,"show",e)},expression:"endData.endBg.image.show"}},[t._v("图片")])],1),t._v(" "),a("div",{staticClass:"upload"},[a("div",{staticClass:"img-box"},[a("img",{attrs:{src:t.resourceData[t.endData.endBg.image.name],alt:"",width:"131",height:"96"}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改图片")]),t._v(" "),a("input",{attrs:{type:"file"},on:{change:function(e){return t.uploadImage(e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.endBg.image.x,callback:function(e){t.$set(t.endData.endBg.image,"x",e)},expression:"endData.endBg.image.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.endBg.image.y,callback:function(e){t.$set(t.endData.endBg.image,"y",e)},expression:"endData.endBg.image.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.endBg.image.width,callback:function(e){t.$set(t.endData.endBg.image,"width",e)},expression:"endData.endBg.image.width"}},[a("template",{slot:"prepend"},[t._v("W：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.endBg.image.height,callback:function(e){t.$set(t.endData.endBg.image,"height",e)},expression:"endData.endBg.image.height"}},[a("template",{slot:"prepend"},[t._v("H：")])],2),t._v(" "),a("div",{staticClass:"edit-checkbox-title"},[a("el-checkbox",{attrs:{size:"small"},on:{change:function(e){return t.setResource("endBg","animate")}},model:{value:t.endData.endBg.animate.show,callback:function(e){t.$set(t.endData.endBg.animate,"show",e)},expression:"endData.endBg.animate.show"}},[t._v("动画")])],1),t._v(" "),a("div",{staticClass:"upload"},[a("span",{staticClass:"file-title"},[t._v("\n                动画文件：\n            ")]),t._v(" "),a("div",{staticClass:"animate-box"},[a("span",{domProps:{textContent:t._s(t.endData.endBg.animate.name)}})]),t._v(" "),a("div",{staticClass:"upload-btn"},[a("div",{staticClass:"upload-btn-file"},[a("span",[t._v("更改文件")]),t._v(" "),a("input",{attrs:{type:"file",multiple:"multiple"},on:{change:function(e){return t.uploadAnimation(e)}}})])])]),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.endBg.animate.x,callback:function(e){t.$set(t.endData.endBg.animate,"x",e)},expression:"endData.endBg.animate.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.endBg.animate.y,callback:function(e){t.$set(t.endData.endBg.animate,"y",e)},expression:"endData.endBg.animate.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.endBg.animate.scale,callback:function(e){t.$set(t.endData.endBg.animate,"scale",e)},expression:"endData.endBg.animate.scale"}},[a("template",{slot:"prepend"},[t._v("Scale：")])],2),t._v(" "),a("div",{staticClass:"edit-switch"},[a("span",[t._v("loop")]),t._v(" "),a("el-switch",{attrs:{"active-color":"#77DC04","inactive-color":"#ff4949"},model:{value:t.endData.endBg.animate.loop,callback:function(e){t.$set(t.endData.endBg.animate,"loop",e)},expression:"endData.endBg.animate.loop"}})],1)],1):t._e(),t._v(" "),a("div",{staticClass:"end-title"},[a("i",{ref:"goldNumTitle",class:t.tabShowStatus.goldNum?"el-icon-arrow-down":"el-icon-arrow-right",on:{click:function(e){return t.tabShow("goldNum","goldNumTitle")}}}),t._v(" "),a("span",{on:{click:function(e){return t.tabShow("goldNum","goldNumTitle")}}},[t._v("\n            金币文字\n        ")])]),t._v(" "),t.tabShowStatus.goldNum?a("div",{staticClass:"end-inner"},[a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.goldText.x,callback:function(e){t.$set(t.endData.goldText,"x",e)},expression:"endData.goldText.x"}},[a("template",{slot:"prepend"},[t._v("X：")])],2),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.goldText.y,callback:function(e){t.$set(t.endData.goldText,"y",e)},expression:"endData.goldText.y"}},[a("template",{slot:"prepend"},[t._v("Y：")])],2),t._v(" "),a("div",{staticClass:"edit-select"},[a("span",[t._v("字体：")]),t._v(" "),a("el-select",{attrs:{placeholder:"请选择",size:"mini"},model:{value:t.endData.goldText.fontFamily,callback:function(e){t.$set(t.endData.goldText,"fontFamily",e)},expression:"endData.goldText.fontFamily"}},t._l(t.fontFamily,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),a("el-input",{attrs:{placeholder:"请输入内容",size:"mini"},model:{value:t.endData.goldText.fontSize,callback:function(e){t.$set(t.endData.goldText,"fontSize",e)},expression:"endData.goldText.fontSize"}},[a("template",{slot:"prepend"},[t._v("字号：")])],2),t._v(" "),a("div",{staticClass:"edit-select"},[a("span",[t._v("颜色：")]),t._v(" "),a("el-color-picker",{model:{value:t.endData.goldText.color,callback:function(e){t.$set(t.endData.goldText,"color",e)},expression:"endData.goldText.color"}})],1),t._v(" "),a("div",{staticClass:"font-style"},[a("span",{class:t.endData.goldText.strong?"font-style-color":"",on:{click:function(e){return t.setGoldTextFontStyle("strong")}}},[t._v("B")]),t._v(" "),a("span",{class:t.endData.goldText.italic?"font-style-color":"",on:{click:function(e){return t.setGoldTextFontStyle("italic")}}},[t._v("I")])])],1):t._e()]):t._e()},staticRenderFns:[]};var I=a("C7Lr")(C,B,!1,function(t){a("RREg")},"data-v-246a5cd2",null).exports,T=(a("E/U7"),a("qqHy")),N=a.n(T),k=a("7Q5p"),A=a.n(k),$=a("3vtO"),E=(a("004W"),a("qWh7")),O=a.n(E);let F,j;var P={name:"start",data:()=>({isShow:!1,number:0,answerStatus:[],answerData:[],option:["A","B","C","D","E","F","G","H"]}),methods:{createApp:()=>new n.Application({width:1920,height:1080,autoSize:!0,transparent:!0})},components:{},created(){document.getElementsByClassName("page-loading")[0].style.display="block"},props:["allData"],destroyed(){PIXI.sound.stopAll(),app.destroy()},mounted(){PIXI.sound.stopAll(),document.getElementsByClassName("page-loading")[0].style.display="block",window.app=this.createApp(),app.view.style.width="19.2rem",app.view.style.height="10.8rem",app.view.id="appCanvas",window.stage=app.stage;this.$refs.canvas.appendChild(app.view),stage.interactive=!0,Object($.load)().then(t=>{console.log("%c资源加载完啦✌️","color:#FF323B;font-weight:bold;"),this.$nextTick(()=>{window.question=t.question.data,F=t.question.data,j=t.question.data;let e=new O.a(F.one.start,t);stage.addChild(e),store.state.testNum=t.question.data.sources.length,document.getElementsByClassName("page-loading")[0].style.display="none",Object(c.RenderAllData)(!0,this.allData),function(){let t=document.querySelectorAll(".container");for(let e=0;e<t.length;e++)t[e].style.width=window.clientWidth-340+"px",t[e].style.height=(window.clientWidth-340)*(10.8/19.2)+"px"}()})})}},M={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("div",{ref:"canvas",staticClass:"canvas"}),this._v(" "),e("img",{staticClass:"logo",attrs:{src:"static/images/logo.png",id:"logo"}})])},staticRenderFns:[]};var R=a("C7Lr")(P,M,!1,function(t){a("MzDr")},"data-v-b3847b56",null).exports;let z=!0;a("IcnI");var G={name:"Edit",data:()=>({allData:null,showStatus:!1,publicImg:"",maskStatus:!1,startData:null,activeName:"game",activeName1:"game1",modelName:A.a.title,version:A.a.version,label:"2",submitStatus:!1}),components:{start:r,game:D,end:I,index:R},methods:{setContainer(t){store.dispatch("setPageNumber",-1),"ftp"===t?"start"===this.activeName?(this.allData.one.start.show&&(window.stage.getChildByName("START").visible=!0),window.stage.getChildByName("GAME").visible=!1,window.stage.getChildByName("gameBgSound")&&window.stage.setChildIndex(window.stage.getChildByName("gameBgSound"),window.stage.children.length-1)):"game"===this.activeName&&(window.stage.getChildByName("GAME").visible=!0,window.stage.getChildByName("GAME").children.forEach(t=>{t.visible=!1}),window.stage.getChildByName("GAME").getChildByName("GAME0").visible=!0):"start1"===this.activeName1?(this.allData.one.start.show&&(window.stage.getChildByName("START").visible=!0),window.stage.getChildByName("GAME").visible=!1):"game1"===this.activeName1&&(window.stage.getChildByName("GAME").visible=!0,window.stage.getChildByName("GAME").children.forEach(t=>{t.visible=!1}),window.stage.getChildByName("GAME").getChildByName("GAME0").visible=!0)},reload(){location.reload(!0)},reloadIframe(){location.reload(!0)},changeType(){"1"===this.label?this.allData.interface=!0:this.allData.interface=!1},getJSON(){this.$http.get("/getJSON",{params:{}}).then(t=>{this.allData=t,console.log(this.allData.interface),this.allData.interface?this.label="1":this.label="2";let e=N()(".container"),a=window.clientWidth-340+"px",i=(window.clientWidth-340)*(10.8/19.2)+"px";e.css({width:a,height:i}),this.showStatus=!0})},globalComputed(){let t={singleCount:5,totalTime:1500,stemLength:5,answers:[]};t.singleCount=1,t.stemLength=this.allData.sources.length;let e=0;this.allData.sources.forEach((a,i)=>{let s,n=a.rightKey,l=n.text;s="sentence"===n.contentType?.8*n.text.replace(/\s+/g,"").length+2:.5*n.text.replace(/\s+/g,"").length+2,0===i&&(s+=3),s=Math.ceil(s),e+=s;let o={id:i,text:l,singleTime:s};t.answers.push(o)}),t.totalTime=Math.ceil(e+3+3*t.stemLength+1),this.allData.preFetch=t},writeJSON(t="submit"){if(this.globalComputed(),z){z=!1;let e=JSON.parse(JSON.stringify(this.allData.one.end));!function t(e){Object.values(e).forEach((a,i)=>{"object"==typeof a?t(a):"boolean"==typeof a?e[Object.keys(e)[i]]=!1:"string"==typeof a?e[Object.keys(e)[i]]="":"number"==typeof a&&(e[Object.keys(e)[i]]=0)})}(e),"1"===this.label&&(this.allData.one.end=e,console.log(this.allData.one.end)),this.$http.post("/writeJSON",{dataList:JSON.stringify(this.allData)}).then(e=>{if(this.$message({type:e.type,message:e.message}),this.submitStatus=!0,N()(".submitBtn").removeClass("submitActive"),"preview"===t){let t,e="start"===this.activeName||"start1"===this.activeName1||-1==store.state.pageNumber?"true":"false";"true"===e&&store.dispatch("setPageNumber",0),t="http://localhost:8888/#/preview?id="+store.state.pageNumber+"&startStatus="+e,window.open(t)}setTimeout(()=>{this.submitStatus=!1,z=!0,N()(".submitBtn").addClass("submitActive")},1e3)})}}},mounted(){let t;function e(){let t=document.querySelectorAll(".container");for(let e=0;e<t.length;e++)t[e].style.width=window.clientWidth-340+"px",t[e].style.height=(window.clientWidth-340)*(10.8/19.2)+"px"}this.getJSON(),window.onresize=e,this.$nextTick(()=>{e()}),t=window.location.href.split("#")[0]}},X={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[t.allData?a("div",{staticClass:"iframe"},[a("index",{ref:"container",attrs:{allData:t.allData}})],1):t._e(),t._v(" "),t.showStatus?a("div",{staticClass:"edit"},[a("header",[a("h1",{domProps:{textContent:t._s(t.modelName)}}),t._v(" "),a("p",{domProps:{textContent:t._s("版本号：v"+t.version)}})]),t._v(" "),a("div",{staticClass:"edit-tab"},[a("el-radio",{attrs:{label:"1"},on:{change:function(e){return t.changeType()}},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}},[t._v("课件平台組课")]),t._v(" "),a("el-radio",{attrs:{label:"2"},on:{change:function(e){return t.changeType()}},model:{value:t.label,callback:function(e){t.label=e},expression:"label"}},[t._v("ftp組课")])],1),t._v(" "),"1"===t.label?a("el-tabs",{attrs:{type:"border-card",value:"内容页",stretch:!0},on:{"tab-click":function(e){return t.setContainer("new")}},model:{value:t.activeName1,callback:function(e){t.activeName1=e},expression:"activeName1"}},[a("el-tab-pane",{attrs:{label:"开始页",name:"start1"}},["start1"===t.activeName1?a("start",{ref:"start1",attrs:{allData:t.allData},on:{reload:t.reloadIframe}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"内容页",name:"game1"}},["game1"===t.activeName1?a("game",{ref:"game1",attrs:{allData:t.allData},on:{reload:t.reloadIframe}},[t._v(">\n\n                ")]):t._e()],1)],1):t._e(),t._v(" "),"2"===t.label?a("el-tabs",{attrs:{type:"border-card",value:"内容页",stretch:!0},on:{"tab-click":function(e){return t.setContainer("ftp")}},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"开始页",name:"start"}},["start"===t.activeName?a("start",{ref:"start",attrs:{allData:t.allData},on:{reload:t.reloadIframe}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"内容页",name:"game"}},["game"===t.activeName?a("game",{ref:"game",attrs:{allData:t.allData},on:{reload:t.reloadIframe}}):t._e()],1),t._v(" "),a("el-tab-pane",{attrs:{label:"结果页",name:"end"}},["end"===t.activeName?a("end",{ref:"end",attrs:{allData:t.allData},on:{reload:t.reloadIframe}}):t._e()],1)],1):t._e(),t._v(" "),a("div",{staticClass:"submit"},[a("el-button",{staticClass:"submitBtn submitActive",attrs:{type:"primary"},on:{click:function(e){return t.writeJSON("preview")}}},[t._v("预览")]),t._v(" "),a("el-button",{staticClass:"submitBtn submitActive",attrs:{type:"primary",disabled:t.submitStatus},on:{click:function(e){return t.writeJSON()}}},[t._v("保存")])],1)],1):t._e()])},staticRenderFns:[]};var W=a("C7Lr")(G,X,!1,function(t){a("4Ej+")},null,null);e.a=W.exports},WHpE:function(t,e,a){"use strict";a("E/U7");var i=a("qqHy"),s=a.n(i),n=a("7Q5p"),l=a.n(n),o={name:"Edit",data:()=>({allData:null,showStatus:!1,publicImg:"",maskStatus:!1,startData:null,activeName:"game",activeName1:"game1",modelName:l.a.title,version:l.a.version,label:"2",submitStatus:!1}),methods:{reload(){location.reload(!0)}},mounted(){let t;s()("#submitButton").on("click",function(){if(window.store.state.pShow){console.log("新接口强制提交");let t={type:"getAnswer"};s()(".iframe iframe")[0].contentWindow.postMessage(t,"*")}else{console.log("旧接口强制提交");let t={type:"resubmitAnswer"};s()(".iframe iframe")[0].contentWindow.postMessage(t,"*")}}),window.addEventListener("message",function(t){if("onload"==t.data.type)console.log("onload接口");else if("submitAnswer"==t.data.type){let e=t.data.data.testAnswer,a=t.data.data.testNum,i=0,n=0,l=0;for(let t=0;t<a;t++){if(void 0==e[t])continue;let a=e[t],s=a.answer.length;"string"==typeof a.answer&&(s=1);let o=a.rightnum;a.isright&&n++,0==o&&0==a.type&&(l++,o=0),o>0&&0==a.type&&(o=s),a.is_right=o==s?1:0,a.rate=o/s,i+=a.rate}let o=i/a,r={goldnum:l=(l+=Math.ceil(10*o))>10?10:l,result:t.data.data.testAnswer};console.log("newData"),console.log(r);let m={type:"answerResult",data:r};s()(".iframe iframe")[0].contentWindow.postMessage(m,"*")}else if("submitData"==t.data.type){let t={type:"resubmitAnswer"};s()(".iframe iframe")[0].contentWindow.postMessage(t,"*")}else if("close"==t.data.type)s()(".iframe iframe").attr("src",""),s()(".submitData").hide();else if("answer"==t.data.type){let e={type:"answerTextResult",data:t.data.data};s()(".iframe iframe")[0].contentWindow.postMessage(e,"*")}}),t="http://localhost:8888/#/?id="+this.$route.query.id+"&startStatus="+this.$route.query.startStatus,document.getElementById("iframeWindow").src=t}},r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("img",{attrs:{src:"static/images/reload.png",alt:"",id:"reload"},on:{click:function(e){return t.reload()}}}),t._v(" "),t._m(0)])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"iframe"},[e("button",{attrs:{id:"submitButton"}},[this._v("强制提交")]),this._v(" "),e("iframe",{attrs:{src:"/",id:"iframeWindow",frameborder:"0"}})])}]};var m=a("C7Lr")(o,r,!1,function(t){a("8lK+")},"data-v-56dc9cd6",null);e.a=m.exports},ZMII:function(t,e){},cWYQ:function(t,e){},zel7:function(t,e,a){"use strict";var i={data:()=>({resultDate:store.state.resultArr}),mounted(){console.log("平台校验结果页出现")}},s={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-table",{staticClass:"resultTable",staticStyle:{width:"19.2rem",positon:"absolute",left:"50%","margin-left":"-9.6rem",top:"-5rem",padding:"0 1rem"},attrs:{data:this.resultDate}},[e("el-table-column",{staticStyle:{width:"1rem"},attrs:{prop:"id",label:"题号"}}),this._v(" "),e("el-table-column",{staticStyle:{"text-align":"center"},attrs:{prop:"userAnswerContent",label:"你的答案"}}),this._v(" "),e("el-table-column",{attrs:{prop:"rightAnswerContent",label:"正确答案"}}),this._v(" "),e("el-table-column",{attrs:{prop:"isRight",label:"校验结果"}})],1)},staticRenderFns:[]};var n=a("C7Lr")(i,s,!1,function(t){a("CZzb")},"data-v-0b169922",null);e.a=n.exports},zwgh:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.load=function(){return window.res?new Promise((t,e)=>{console.info(2),t(window.res)}):(console.info(1),new Promise((t,e)=>{s.add("question","static/content.json"),s.add("resources","static/resource.json"),s.load(()=>{let e=PIXI.loader.resources.resources.data;e.forEach(t=>{if(s.add(t.key,t.path),t.key.indexOf("image")>-1){var e=new Image;e.src=t.path,e.onerror=function(t){console.log(t),errorArr.unshift(dataAssembling({msg:"Resource not loaded error",url:t.target.src,type:"resourceLoadERROR"}))}}else if(t.key.indexOf("audio")>-1){var a=new Audio;a.src=t.path,a.onerror=function(e){errorArr.unshift(dataAssembling({msg:"Resource not loaded error",url:t.path,type:"resourceLoadERROR"}))}}}),s.load((e,a)=>{window.res=a,t(a)}),s.onError.add(t=>{console.log(t)}),s.onProgress.add(t=>{document.getElementsByClassName("runner")[0].style.width=6.8*t.progress/100+"rem"}),s.onComplete.add(t=>{})})}))},e.getAnimation=function(t){return new PIXI.spine.Spine(res[t].spineData)},e.getSound=function(t){return res[t].data},e.createSprite=function(t){return new i.Sprite(t)},e.getOptionTexture=function(t,e){return res[t].textures[e]},e.getTexture=function(t){return res[t].texture};var i=a("ghBa");a.n(i);a("P6Fy");let s=PIXI.loader}},["NHnr"]);